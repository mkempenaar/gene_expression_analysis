<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>B Annotating an RNA-Seq Experiment | Analysis of Gene Expression</title>
  <meta name="description" content="Course Syllabus for BFV: Theme 07 course" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="B Annotating an RNA-Seq Experiment | Analysis of Gene Expression" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course Syllabus for BFV: Theme 07 course" />
  <meta name="github-repo" content="mkempenaar/gene_expression_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="B Annotating an RNA-Seq Experiment | Analysis of Gene Expression" />
  
  <meta name="twitter:description" content="Course Syllabus for BFV: Theme 07 course" />
  

<meta name="author" content="Marcel Kempenaar" />


<meta name="date" content="2020-02-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a1-batch-data-loading.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Theme 07 - Analysis of Gene Expression</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#analysis-of-gene-expression-project"><i class="fa fa-check"></i>Analysis of Gene Expression Project</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chapter-1.html"><a href="chapter-1.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="chapter-1.html"><a href="chapter-1.html#theme-7---analysis-of-gene-expression-project"><i class="fa fa-check"></i><b>1.1</b> Theme 7 - Analysis of Gene Expression Project</a></li>
<li class="chapter" data-level="1.2" data-path="chapter-1.html"><a href="chapter-1.html#project-deliverables"><i class="fa fa-check"></i><b>1.2</b> Project Deliverables</a></li>
<li class="chapter" data-level="1.3" data-path="chapter-1.html"><a href="chapter-1.html#project-schedule"><i class="fa fa-check"></i><b>1.3</b> Project Schedule</a></li>
<li class="chapter" data-level="1.4" data-path="chapter-1.html"><a href="chapter-1.html#grading"><i class="fa fa-check"></i><b>1.4</b> Grading</a></li>
<li class="chapter" data-level="1.5" data-path="chapter-1.html"><a href="chapter-1.html#project-proposal"><i class="fa fa-check"></i><b>1.5</b> Project Proposal</a></li>
<li class="chapter" data-level="1.6" data-path="chapter-1.html"><a href="chapter-1.html#lab-journal"><i class="fa fa-check"></i><b>1.6</b> <em>Lab Journal</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter-2.html"><a href="chapter-2.html"><i class="fa fa-check"></i><b>2</b> Discovering Data Sets</a><ul>
<li class="chapter" data-level="2.1" data-path="chapter-2.html"><a href="chapter-2.html#finding-public-data"><i class="fa fa-check"></i><b>2.1</b> Finding Public Data Sets of Interest</a></li>
<li class="chapter" data-level="2.2" data-path="chapter-2.html"><a href="chapter-2.html#ncbi-geo"><i class="fa fa-check"></i><b>2.2</b> The NCBI <em>Gene Expression Omnibus</em></a></li>
<li class="chapter" data-level="2.3" data-path="chapter-2.html"><a href="chapter-2.html#project-proposal_ch2"><i class="fa fa-check"></i><b>2.3</b> Creating a Project Proposal</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3.html"><a href="chapter-3.html"><i class="fa fa-check"></i><b>3</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="chapter-3.html"><a href="chapter-3.html#expl-data"><i class="fa fa-check"></i><b>3.1</b> Exploring the Available Project Data</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-3.html"><a href="chapter-3.html#loading-data"><i class="fa fa-check"></i><b>3.2</b> Loading data into R</a></li>
<li class="chapter" data-level="3.3" data-path="chapter-3.html"><a href="chapter-3.html#ch3_example_data"><i class="fa fa-check"></i><b>3.3</b> Example Data</a></li>
<li class="chapter" data-level="3.4" data-path="chapter-3.html"><a href="chapter-3.html#EDA_part1"><i class="fa fa-check"></i><b>3.4</b> Visualizing using <code>summary</code>, <code>boxplot</code>, <code>density plot</code>, <code>scatterplot</code> &amp; <code>MA-plot</code></a><ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-3.html"><a href="chapter-3.html#eda_statistics"><i class="fa fa-check"></i><b>3.4.1</b> Statistics</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-3.html"><a href="chapter-3.html#eda_boxplots"><i class="fa fa-check"></i><b>3.4.2</b> Boxplots</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter-3.html"><a href="chapter-3.html#eda_density_plot"><i class="fa fa-check"></i><b>3.4.3</b> Density Plots</a></li>
<li class="chapter" data-level="3.4.4" data-path="chapter-3.html"><a href="chapter-3.html#eda_scatter_plot"><i class="fa fa-check"></i><b>3.4.4</b> Scatterplots</a></li>
<li class="chapter" data-level="3.4.5" data-path="chapter-3.html"><a href="chapter-3.html#MA_plot"><i class="fa fa-check"></i><b>3.4.5</b> MA-plot</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="chapter-3.html"><a href="chapter-3.html#EDA_part2"><i class="fa fa-check"></i><b>3.5</b> Visualizing using <code>heatmap</code>, <code>MDS</code> &amp; <code>PCA</code></a><ul>
<li class="chapter" data-level="3.5.1" data-path="chapter-3.html"><a href="chapter-3.html#normalization"><i class="fa fa-check"></i><b>3.5.1</b> Normalization</a></li>
<li class="chapter" data-level="3.5.2" data-path="chapter-3.html"><a href="chapter-3.html#eda_distance"><i class="fa fa-check"></i><b>3.5.2</b> Distance Calculation</a></li>
<li class="chapter" data-level="3.5.3" data-path="chapter-3.html"><a href="chapter-3.html#eda_heatmap"><i class="fa fa-check"></i><b>3.5.3</b> Sample Distances using a Heatmap</a></li>
<li class="chapter" data-level="3.5.4" data-path="chapter-3.html"><a href="chapter-3.html#eda_mds"><i class="fa fa-check"></i><b>3.5.4</b> Multi-Dimensional Scaling</a></li>
<li class="chapter" data-level="3.5.5" data-path="chapter-3.html"><a href="chapter-3.html#eda_pca"><i class="fa fa-check"></i><b>3.5.5</b> Principal Component Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapter-3.html"><a href="chapter-3.html#cleaning-data"><i class="fa fa-check"></i><b>3.6</b> Cleaning Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-4.html"><a href="chapter-4.html"><i class="fa fa-check"></i><b>4</b> Discovering Differentialy Expressed Genes (DEGs)</a><ul>
<li class="chapter" data-level="4.1" data-path="chapter-4.html"><a href="chapter-4.html#deg-preprocessing"><i class="fa fa-check"></i><b>4.1</b> Pre-processing</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-4.html"><a href="chapter-4.html#deg-fc"><i class="fa fa-check"></i><b>4.2</b> The <em>Fold Change</em> Value</a></li>
<li class="chapter" data-level="4.3" data-path="chapter-4.html"><a href="chapter-4.html#deg-manual"><i class="fa fa-check"></i><b>4.3</b> Using Manual Methods (<code>t-test</code> &amp; <code>ANOVA</code>)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="chapter-4.html"><a href="chapter-4.html#deg-ttest"><i class="fa fa-check"></i><b>4.3.1</b> Students T-test</a></li>
<li class="chapter" data-level="4.3.2" data-path="chapter-4.html"><a href="chapter-4.html#deg-anova"><i class="fa fa-check"></i><b>4.3.2</b> Analysis of Variance (<code>ANOVA</code>)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chapter-4.html"><a href="chapter-4.html#deg-mtc"><i class="fa fa-check"></i><b>4.4</b> Multiple Testing Correction</a><ul>
<li class="chapter" data-level="4.4.1" data-path="chapter-4.html"><a href="chapter-4.html#inspecting-manual-test-results"><i class="fa fa-check"></i><b>4.4.1</b> Inspecting Manual Test Results</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chapter-4.html"><a href="chapter-4.html#deg-bioconductor"><i class="fa fa-check"></i><b>4.5</b> Using Bioconductor Packages</a><ul>
<li class="chapter" data-level="4.5.1" data-path="chapter-4.html"><a href="chapter-4.html#deg-design"><i class="fa fa-check"></i><b>4.5.1</b> The <code>Design</code> (matrix)</a></li>
<li class="chapter" data-level="4.5.2" data-path="chapter-4.html"><a href="chapter-4.html#deg-deseq2"><i class="fa fa-check"></i><b>4.5.2</b> <code>DESeq2</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="chapter-4.html"><a href="chapter-4.html#deg-edger"><i class="fa fa-check"></i><b>4.5.3</b> <code>edgeR</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-5.html"><a href="chapter-5.html"><i class="fa fa-check"></i><b>5</b> Data Analysis and Visualization</a><ul>
<li class="chapter" data-level="5.1" data-path="chapter-5.html"><a href="chapter-5.html#volcano"><i class="fa fa-check"></i><b>5.1</b> Volcano Plot</a></li>
<li class="chapter" data-level="5.2" data-path="chapter-5.html"><a href="chapter-5.html#venn-diagram"><i class="fa fa-check"></i><b>5.2</b> Venn Diagram</a></li>
<li class="chapter" data-level="5.3" data-path="chapter-5.html"><a href="chapter-5.html#clustering"><i class="fa fa-check"></i><b>5.3</b> Clustering</a></li>
<li class="chapter" data-level="5.4" data-path="chapter-5.html"><a href="chapter-5.html#pathway-analysis"><i class="fa fa-check"></i><b>5.4</b> Pathway Analysis</a><ul>
<li class="chapter" data-level="5.4.1" data-path="chapter-5.html"><a href="chapter-5.html#gene-functional-classification-using-david-100-degs"><i class="fa fa-check"></i><b>5.4.1</b> Gene Functional Classification using DAVID (&gt;100 DEGs)</a></li>
<li class="chapter" data-level="5.4.2" data-path="chapter-5.html"><a href="chapter-5.html#kegg-pathway-visualization-10-degs"><i class="fa fa-check"></i><b>5.4.2</b> KEGG-pathway Visualization (&gt;10 DEGs)</a></li>
<li class="chapter" data-level="5.4.3" data-path="chapter-5.html"><a href="chapter-5.html#spia"><i class="fa fa-check"></i><b>5.4.3</b> Signaling Pathway Impact Analysis (&gt;20 DEGs)</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="a1-batch-data-loading.html"><a href="a1-batch-data-loading.html"><i class="fa fa-check"></i><b>A</b> Appendix A: Batch Loading Expression Data in R</a><ul>
<li class="chapter" data-level="A.1" data-path="a1-batch-data-loading.html"><a href="a1-batch-data-loading.html#decompressing"><i class="fa fa-check"></i><b>A.1</b> Decompressing</a></li>
<li class="chapter" data-level="A.2" data-path="a1-batch-data-loading.html"><a href="a1-batch-data-loading.html#determining-data-format"><i class="fa fa-check"></i><b>A.2</b> Determining Data Format</a></li>
<li class="chapter" data-level="A.3" data-path="a1-batch-data-loading.html"><a href="a1-batch-data-loading.html#loading-data-1"><i class="fa fa-check"></i><b>A.3</b> Loading Data</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="a2-annotation.html"><a href="a2-annotation.html"><i class="fa fa-check"></i><b>B</b> Annotating an RNA-Seq Experiment</a><ul>
<li class="chapter" data-level="B.1" data-path="a2-annotation.html"><a href="a2-annotation.html#download-geo"><i class="fa fa-check"></i><b>B.1</b> Downloading annotation data from GEO</a></li>
<li class="chapter" data-level="B.2" data-path="a2-annotation.html"><a href="a2-annotation.html#manually-annotate"><i class="fa fa-check"></i><b>B.2</b> Manual Data Annotation</a><ul>
<li class="chapter" data-level="B.2.1" data-path="a2-annotation.html"><a href="a2-annotation.html#annotationDBI"><i class="fa fa-check"></i><b>B.2.1</b> Using <code>AnnotationDBI</code></a></li>
<li class="chapter" data-level="B.2.2" data-path="a2-annotation.html"><a href="a2-annotation.html#using-biomart"><i class="fa fa-check"></i><b>B.2.2</b> Using <code>biomaRt</code></a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="a2-annotation.html"><a href="a2-annotation.html#references"><i class="fa fa-check"></i><b>B.3</b> References</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysis of Gene Expression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a2-annotation" class="section level1">
<h1><span class="header-section-number">B</span> Annotating an RNA-Seq Experiment</h1>
<p>This chapter describes <em>annotate</em> the data, meaning assigning names and functions to our Differentially Expressed Genes. This step can either be very easy or a bit more challenging depending on the data source of your project. The first example is relevant if your data set originated from the NCBI <strong>GEO</strong>, which ‘should’ always be annotated by default. If you have found your data set elsewhere (and do not have a GEO idetifier for your project), skip to the <a href="a2-annotation.html#manually-annotate">Manually annotate your data</a> section below.</p>
<p>The goal of this chapter is to - at least - find a Gene Symbol or common ID (NCBI/ Ensembl) for each gene. Using this information it will be much easier to find relevant information from other online sources to say something about the functionality and impact of your DEGs.</p>
<p>Even though you might be lucky and either already have your data or a simple GEO query results in everything you want/ need, you are tasked to <em>also</em> perform the manual annotation phase even if you will not use any of the found annotation data. Having written the code to access these sources is a good excercise in using complex Bioconductor packages. Also, you can always use this to find more information should you require this later on.</p>
<div id="download-geo" class="section level2">
<h2><span class="header-section-number">B.1</span> Downloading annotation data from GEO</h2>
<p>Given the <code>GSE****</code> id of your experiment you can download any available (annotation)data from GEO using the <code>GEOquery</code> library. For the example experiment used previously, the following code downloads two files; a <code>series_matrix.txt.gz</code> file and a <code>.soft</code> file that are both also available for download from the NCBI GEO website. Note the <code>destdir</code> argument for storing it in a known location instead of the <code>/tmp</code> folder for later use.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="kw">library</span>(GEOquery)</a>
<a class="sourceLine" id="cb62-2" data-line-number="2">gse.id &lt;-<span class="st"> &#39;GSE101942&#39;</span></a>
<a class="sourceLine" id="cb62-3" data-line-number="3">gse &lt;-<span class="st"> </span><span class="kw">getGEO</span>(gse.id, <span class="dt">destdir =</span> <span class="st">&quot;./data/&quot;</span>, <span class="dt">getGPL =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Once downloaded, you can load the data later using:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="kw">library</span>(GEOquery)</a>
<a class="sourceLine" id="cb63-2" data-line-number="2">gse &lt;-<span class="st"> </span><span class="kw">getGEO</span>(<span class="dt">filename =</span> <span class="st">&#39;./data/GSE101942_series_matrix.txt.gz&#39;</span>) <span class="co"># Sample details</span></a>
<a class="sourceLine" id="cb63-3" data-line-number="3">gpl &lt;-<span class="st"> </span><span class="kw">getGEO</span>(<span class="dt">filename =</span> <span class="st">&#39;./data/GPL11154.soft&#39;</span>) <span class="co"># Platform details</span></a>
<a class="sourceLine" id="cb63-4" data-line-number="4"><span class="co"># Print some metadata of the gse object</span></a>
<a class="sourceLine" id="cb63-5" data-line-number="5">gse</a></code></pre></div>
<pre><code>## ExpressionSet (storageMode: lockedEnvironment)
## assayData: 0 features, 12 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: GSM2719212 GSM2719213 ... GSM2719223 (12 total)
##   varLabels: title geo_accession ... ploidy:ch1 (50 total)
##   varMetadata: labelDescription
## featureData: none
## experimentData: use &#39;experimentData(object)&#39;
## Annotation: GPL11154</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="co"># And the structure of the gpl object</span></a>
<a class="sourceLine" id="cb65-2" data-line-number="2"><span class="kw">str</span>(gpl)</a></code></pre></div>
<pre><code>## Formal class &#39;GPL&#39; [package &quot;GEOquery&quot;] with 2 slots
##   ..@ dataTable:Formal class &#39;GEODataTable&#39; [package &quot;GEOquery&quot;] with 2 slots
##   .. .. ..@ columns:&#39;data.frame&#39;:    0 obs. of  2 variables:
##   .. .. .. ..$ Column     : chr(0) 
##   .. .. .. ..$ Description: Factor w/ 0 levels: 
##   .. .. ..@ table  :&#39;data.frame&#39;:    0 obs. of  0 variables
##   ..@ header   :List of 14
##   .. ..$ contact_country : chr &quot;USA&quot;
##   .. ..$ contact_name    : chr &quot;,,GEO&quot;
##   .. ..$ data_row_count  : chr &quot;0&quot;
##   .. ..$ distribution    : chr &quot;virtual&quot;
##   .. ..$ geo_accession   : chr &quot;GPL11154&quot;
##   .. ..$ last_update_date: chr &quot;May 16 2018&quot;
##   .. ..$ organism        : chr &quot;Homo sapiens&quot;
##   .. ..$ sample_id       : chr [1:91613] &quot;GSM616127&quot; &quot;GSM616128&quot; &quot;GSM616129&quot; &quot;GSM663427&quot; ...
##   .. ..$ series_id       : chr [1:6258] &quot;GSE16256&quot; &quot;GSE16368&quot; &quot;GSE17312&quot; &quot;GSE18927&quot; ...
##   .. ..$ status          : chr &quot;Public on Nov 02 2010&quot;
##   .. ..$ submission_date : chr &quot;Nov 02 2010&quot;
##   .. ..$ taxid           : chr &quot;9606&quot;
##   .. ..$ technology      : chr &quot;high-throughput sequencing&quot;
##   .. ..$ title           : chr &quot;Illumina HiSeq 2000 (Homo sapiens)&quot;</code></pre>
<p>The <code>gse</code> object <em>may</em> contain useful information about both samples and genes. Unfortunately for this example dataset there is only information available regarding the samples which we can access in the <code>phenoData</code> <strong>slot</strong>. Slots in R objects are a method of storing multiple data objects into a single R object, in this case this object is called an <code>ExpressionSet</code> (see <code>?ExpressionSet</code> for a description of its contents and structure). For storing information about an experiment this is very handy; you can store a dataframe with the actual expression data, a list containing laboratory information, a chunk of text with an abstract, etc. all in a single object.</p>
<p>The most common datasets found in an <code>ExpressionSet</code> object:
* <code>@assayData</code>: the actual expression data. Most common for microarray experiments and (very) rare for RNA-seq experiments
* <code>@phenoData</code>: sample information, should be present for each GEO dataset
* <code>@featureData</code>: a dataframe holding feature (=gene) information, slightly rare for RNA-seq datasets
* <code>@experimentData</code>: information about the lab which performed the experiment</p>
<p>You already know how to access a column in a data frame using the <code>$</code> notation, and accessing a complete dataframe in the <code>gse</code> object is done using the <code>@</code> symbol:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="co"># Access a data frame containing phenotype information</span></a>
<a class="sourceLine" id="cb67-2" data-line-number="2">gse<span class="op">@</span>phenoData<span class="op">@</span>data</a></code></pre></div>
<p>Here you see that each sample is described using its sample identifier (<code>GSM****</code>), information about the the sample group (<code>title</code> column) and a number of characteristics. The actual information included depends on your dataset.</p>
<table>
<colgroup>
<col width="22%" />
<col width="11%" />
<col width="23%" />
<col width="42%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">title</th>
<th align="center">source_name_ch1</th>
<th align="center">characteristics_ch1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>GSM2719212</strong></td>
<td align="center">C2A</td>
<td align="center">trisomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719213</strong></td>
<td align="center">C2B</td>
<td align="center">trisomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="odd">
<td align="center"><strong>GSM2719214</strong></td>
<td align="center">C2C</td>
<td align="center">trisomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719215</strong></td>
<td align="center">C244-A</td>
<td align="center">disomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="odd">
<td align="center"><strong>GSM2719216</strong></td>
<td align="center">C244-B</td>
<td align="center">disomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719217</strong></td>
<td align="center">C243</td>
<td align="center">disomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
</tbody>
</table>
<p>Contents of the <code>gse@phenoData@data</code> information (selection) (continued below)</p>
<table style="width:57%;">
<colgroup>
<col width="23%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">characteristics_ch1.1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>GSM2719212</strong></td>
<td align="center">ploidy: trisomic</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719213</strong></td>
<td align="center">ploidy: trisomic</td>
</tr>
<tr class="odd">
<td align="center"><strong>GSM2719214</strong></td>
<td align="center">ploidy: trisomic</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719215</strong></td>
<td align="center">ploidy: disomic</td>
</tr>
<tr class="odd">
<td align="center"><strong>GSM2719216</strong></td>
<td align="center">ploidy: disomic</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719217</strong></td>
<td align="center">ploidy: disomic</td>
</tr>
</tbody>
</table>
<p>If your dataset has properly annotated gene information, this should be accessible in the <code>@featureData</code> slot. For instance, the dataset <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE20489"><code>GSE20489</code></a> does have this annotation available. Once loaded, we see that the following annotation columns are present for <em>each gene</em> in the <code>featureData</code> slot (following is a small subset, in total there can be well over 20 columns of information per gene). Also, the <em>metadata</em> listing shows for how many features (=genes, 54675) and samples (54) the expression data is present (in the <code>@assayData</code> slot):</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="co"># This gets a list with a single &#39;ExpressionSet&#39; object</span></a>
<a class="sourceLine" id="cb68-2" data-line-number="2">GSE20489 &lt;-<span class="st"> </span><span class="kw">getGEO</span>(<span class="st">&quot;GSE20489&quot;</span>, <span class="dt">destdir =</span> <span class="st">&#39;../data&#39;</span>)</a>
<a class="sourceLine" id="cb68-3" data-line-number="3"><span class="co"># Print some metadata of the featureData slot</span></a>
<a class="sourceLine" id="cb68-4" data-line-number="4">GSE20489[[<span class="dv">1</span>]]</a></code></pre></div>
<pre><code>## ExpressionSet (storageMode: lockedEnvironment)
## assayData: 54675 features, 54 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: GSM514737 GSM514738 ... GSM514790 (54 total)
##   varLabels: title geo_accession ... tissue:ch1 (39 total)
##   varMetadata: labelDescription
## featureData
##   featureNames: 1007_s_at 1053_at ... AFFX-TrpnX-M_at (54675
##     total)
##   fvarLabels: ID GB_ACC ... Gene Ontology Molecular Function (16
##     total)
##   fvarMetadata: Column Description labelDescription
## experimentData: use &#39;experimentData(object)&#39;
## Annotation: GPL570</code></pre>
<table>
<colgroup>
<col width="15%" />
<col width="35%" />
<col width="23%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">ID</th>
<th align="center">Gene Title</th>
<th align="center">Gene Symbol</th>
<th align="center">ENTREZ_GENE_ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1007_s_at</td>
<td align="center">discoidin domain receptor
tyrosine kinase …</td>
<td align="center">DDR1 /// MIR4640</td>
<td align="center">780 /// 100616237</td>
</tr>
<tr class="even">
<td align="center">1053_at</td>
<td align="center">replication factor C
(activator 1) 2, 40kDa</td>
<td align="center">RFC2</td>
<td align="center">5982</td>
</tr>
<tr class="odd">
<td align="center">117_at</td>
<td align="center">heat shock 70kDa protein
6 (HSP70B’)</td>
<td align="center">HSPA6</td>
<td align="center">3310</td>
</tr>
<tr class="even">
<td align="center">121_at</td>
<td align="center">paired box 8</td>
<td align="center">PAX8</td>
<td align="center">7849</td>
</tr>
<tr class="odd">
<td align="center">1255_g_at</td>
<td align="center">guanylate cyclase
activator 1A (retina)</td>
<td align="center">GUCA1A</td>
<td align="center">2978</td>
</tr>
<tr class="even">
<td align="center">1294_at</td>
<td align="center">microRNA 5193 ///
ubiquitin-like modifier
…</td>
<td align="center">MIR5193 /// UBA7</td>
<td align="center">7318 /// 100847079</td>
</tr>
</tbody>
</table>
<p>Gene information stored in an <code>ExpressionSet</code> object for experiment GSE20489 (continued below)</p>
<table style="width:39%;">
<colgroup>
<col width="38%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Gene Ontology Biological
Process</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0001558 // regulation of
cell growth // in…</td>
</tr>
<tr class="even">
<td align="center">0000278 // mitotic cell
cycle // traceable…</td>
</tr>
<tr class="odd">
<td align="center">0000902 // cell
morphogenesis // inferred
…</td>
</tr>
<tr class="even">
<td align="center">0001655 // urogenital
system development /…</td>
</tr>
<tr class="odd">
<td align="center">0007165 // signal
transduction //
non-trac…</td>
</tr>
<tr class="even">
<td align="center">0006464 // cellular
protein modification p…</td>
</tr>
</tbody>
</table>
</div>
<div id="manually-annotate" class="section level2">
<h2><span class="header-section-number">B.2</span> Manual Data Annotation</h2>
<p>Luckely for us, R offers a number of libraries to automatically retrieve information for large sets of genes, unless you have chosen an organism for which not much data is available. This section demonstrates the use of two such libraries, starting with <code>AnnotationDbi</code> followed by <code>biomaRt</code>.</p>
<p>The <code>AnnotationDbi</code> library downloads a local copy of an organism-specific database with gene information where <code>biomaRt</code> uses online databases to retrieve data given a <code>query</code>. <code>biomaRt</code> offers far more data (over 1000 data fields per organism) but is more complex to use.</p>
<p>Since <code>biomaRt</code> is also relying on online databases it might be a good strategy to annotate only the genes of interest (the DEGs) instead of querying for &gt;20.000 genes while we might only retain 20 after statistical analysis. If you are planning to use <code>biomaRt</code>, skip to the <a href="#discover-degs">Discovering Differentialy Expressed Genes (DEGs)</a> chapter first and then return to the <span id="using-biomart">Using R Bioconductors <code>biomaRt</code></span> section to annotate the data.</p>
<div id="annotationDBI" class="section level3">
<h3><span class="header-section-number">B.2.1</span> Using <code>AnnotationDBI</code></h3>
<p>The <code>AnnotationDbi</code> offers data sets for many organisms in the form of installable libraries and depending on your experiment you need to find the proper library. The example experiment contains samples of the house mouse (Mus musculus) and therefore we select its data set.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="co"># Load the AnnotationDbi interface library</span></a>
<a class="sourceLine" id="cb70-2" data-line-number="2"><span class="kw">library</span>(AnnotationDbi)</a>
<a class="sourceLine" id="cb70-3" data-line-number="3"><span class="co"># Load the Bioconductor installation library (contains &#39;biocLite()&#39;)</span></a>
<a class="sourceLine" id="cb70-4" data-line-number="4"><span class="kw">library</span>(BiocInstaller)</a>
<a class="sourceLine" id="cb70-5" data-line-number="5"></a>
<a class="sourceLine" id="cb70-6" data-line-number="6"><span class="co"># Install and load the organism specific gene database</span></a>
<a class="sourceLine" id="cb70-7" data-line-number="7"><span class="co"># &#39;org&#39; for Organism</span></a>
<a class="sourceLine" id="cb70-8" data-line-number="8"><span class="co"># &#39;Hs&#39; for Homo sapiens</span></a>
<a class="sourceLine" id="cb70-9" data-line-number="9"><span class="co"># &#39;eg&#39; for Entrez Gene IDs</span></a>
<a class="sourceLine" id="cb70-10" data-line-number="10"><span class="co"># (try to load (using the library function) first before installing, it might already be present)</span></a>
<a class="sourceLine" id="cb70-11" data-line-number="11"><span class="kw">biocLite</span>(<span class="st">&#39;org.Hs.eg.db&#39;</span>)</a>
<a class="sourceLine" id="cb70-12" data-line-number="12"><span class="kw">library</span>(org.Hs.eg.db)</a></code></pre></div>
<p>The following information types are available in this database (use the <code>columns</code> function to inspect).</p>
<table style="width:88%;">
<colgroup>
<col width="20%" />
<col width="19%" />
<col width="19%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Columns</th>
<th align="center">Columns</th>
<th align="center">Columns</th>
<th align="center">Columns</th>
<th align="center">Columns</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ACCNUM</td>
<td align="center">ENZYME</td>
<td align="center">IPI</td>
<td align="center">PFAM</td>
<td align="center">UNIGENE</td>
</tr>
<tr class="even">
<td align="center">ALIAS</td>
<td align="center">EVIDENCE</td>
<td align="center">MAP</td>
<td align="center">PMID</td>
<td align="center">UNIPROT</td>
</tr>
<tr class="odd">
<td align="center">ENSEMBL</td>
<td align="center">EVIDENCEALL</td>
<td align="center">OMIM</td>
<td align="center">PROSITE</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">ENSEMBLPROT</td>
<td align="center">GENENAME</td>
<td align="center">ONTOLOGY</td>
<td align="center">REFSEQ</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">ENSEMBLTRANS</td>
<td align="center">GO</td>
<td align="center">ONTOLOGYALL</td>
<td align="center">SYMBOL</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">ENTREZID</td>
<td align="center">GOALL</td>
<td align="center">PATH</td>
<td align="center">UCSCKG</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Available fields in the database</p>
<p>The table below shows the data available for all information types given a randomly chosen <a href="http://www.ncbi.nlm.nih.gov/gene/1080"><em>EntrezID</em> of ‘1080’</a>. Note that the table has been split to show the 24 data types with their values.</p>
<table style="width:100%;">
<colgroup>
<col width="19%" />
<col width="41%" />
<col width="18%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Data Type</th>
<th align="center">Example Value</th>
<th align="center">Data Type</th>
<th align="center">Example Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ACCNUM</td>
<td align="center">AAA35680</td>
<td align="center">IPI</td>
<td align="center">IPI00815998</td>
</tr>
<tr class="even">
<td align="center">ALIAS</td>
<td align="center">ABC35</td>
<td align="center">MAP</td>
<td align="center">7q31.2</td>
</tr>
<tr class="odd">
<td align="center">ENSEMBL</td>
<td align="center">ENSG00000001626</td>
<td align="center">OMIM</td>
<td align="center">167800</td>
</tr>
<tr class="even">
<td align="center">ENSEMBLPROT</td>
<td align="center">NA</td>
<td align="center">ONTOLOGY</td>
<td align="center">MF</td>
</tr>
<tr class="odd">
<td align="center">ENSEMBLTRANS</td>
<td align="center">NA</td>
<td align="center">ONTOLOGYALL</td>
<td align="center">BP</td>
</tr>
<tr class="even">
<td align="center">ENTREZID</td>
<td align="center">NA</td>
<td align="center">PATH</td>
<td align="center">02010</td>
</tr>
<tr class="odd">
<td align="center">ENZYME</td>
<td align="center">3.6.3.49</td>
<td align="center">PFAM</td>
<td align="center">PF14396</td>
</tr>
<tr class="even">
<td align="center">EVIDENCE</td>
<td align="center">IDA</td>
<td align="center">PMID</td>
<td align="center">1284466</td>
</tr>
<tr class="odd">
<td align="center">EVIDENCEALL</td>
<td align="center">ISS</td>
<td align="center">PROSITE</td>
<td align="center">PS50893</td>
</tr>
<tr class="even">
<td align="center">GENENAME</td>
<td align="center">cystic fibrosis transmembrane
conductance regulator</td>
<td align="center">REFSEQ</td>
<td align="center">NM_000492</td>
</tr>
<tr class="odd">
<td align="center">GO</td>
<td align="center"><a href="GO:0005254" class="uri">GO:0005254</a></td>
<td align="center">SYMBOL</td>
<td align="center">CFTR</td>
</tr>
<tr class="even">
<td align="center">GOALL</td>
<td align="center"><a href="GO:0000003" class="uri">GO:0000003</a></td>
<td align="center">UCSCKG</td>
<td align="center">uc064hkb.1</td>
</tr>
</tbody>
</table>
<p>Example values for each field in ‘org.Hs.eg.db’</p>
<p>Retrieving data from the locally stored annotation database can be done using the <code>mapIds</code> function which takes a number of arguments:</p>
<ul>
<li><strong><code>x</code></strong>: the local database to query</li>
<li><strong><code>keys</code></strong>: the IDs from your <em>own</em> data set, most often you have <code>ENSEMBL</code> IDs or gene <code>SYMBOLS</code>. In the example data the <code>rownames</code> of the data set contain the gene <code>SYMBOLS</code> (see Table 1 on page 2)</li>
<li><strong><code>column</code></strong>: the data column to <em>retrieve</em> from the database</li>
<li><strong><code>keytype</code></strong>: the type of data that you <em>provide</em>. In the example data this is a gene <code>SYMBOL</code></li>
<li><strong><code>multiVals</code></strong>: a number of columns contain more then one entry for a single gene, in that case we only want to store the first one.</li>
</ul>
<p>The output of the <code>mapIds</code> function is a single character vector that we can add to our data frame containing the DEGs (in this case the DEGs for the IPSC trisomic vs disomic comparison containing 828 genes stored in the <code>ipsc.tri.vs.di</code> data frame).</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="co"># Retrieve the ENSEMBL gene ID, e.g. &#39;ENSG00000001626&#39;</span></a>
<a class="sourceLine" id="cb71-2" data-line-number="2">ipsc.tri.vs.di<span class="op">$</span>Ensembl &lt;-<span class="st"> </span><span class="kw">mapIds</span>(<span class="dt">x =</span> org.Hs.eg.db,</a>
<a class="sourceLine" id="cb71-3" data-line-number="3">                           <span class="dt">keys=</span><span class="kw">row.names</span>(ipsc.tri.vs.di),</a>
<a class="sourceLine" id="cb71-4" data-line-number="4">                           <span class="dt">column=</span><span class="st">&quot;ENSEMBL&quot;</span>,</a>
<a class="sourceLine" id="cb71-5" data-line-number="5">                           <span class="dt">keytype=</span><span class="st">&quot;SYMBOL&quot;</span>,</a>
<a class="sourceLine" id="cb71-6" data-line-number="6">                           <span class="dt">multiVals=</span><span class="st">&quot;first&quot;</span>)</a>
<a class="sourceLine" id="cb71-7" data-line-number="7"></a>
<a class="sourceLine" id="cb71-8" data-line-number="8"><span class="co"># Retrieve the ENTREZ gene ID, e.g. &#39;12323&#39;</span></a>
<a class="sourceLine" id="cb71-9" data-line-number="9">ipsc.tri.vs.di<span class="op">$</span>EntrezID &lt;-<span class="st"> </span><span class="kw">mapIds</span>(<span class="dt">x =</span> org.Hs.eg.db,</a>
<a class="sourceLine" id="cb71-10" data-line-number="10">                            <span class="dt">keys=</span><span class="kw">row.names</span>(ipsc.tri.vs.di),</a>
<a class="sourceLine" id="cb71-11" data-line-number="11">                            <span class="dt">column=</span><span class="st">&quot;ENTREZID&quot;</span>,</a>
<a class="sourceLine" id="cb71-12" data-line-number="12">                            <span class="dt">keytype=</span><span class="st">&quot;SYMBOL&quot;</span>,</a>
<a class="sourceLine" id="cb71-13" data-line-number="13">                            <span class="dt">multiVals=</span><span class="st">&quot;first&quot;</span>)</a>
<a class="sourceLine" id="cb71-14" data-line-number="14"></a>
<a class="sourceLine" id="cb71-15" data-line-number="15"><span class="co"># Retrieve the KEGG enzyme code, e.g. 2.7.11.17</span></a>
<a class="sourceLine" id="cb71-16" data-line-number="16">ipsc.tri.vs.di<span class="op">$</span>Enzyme &lt;-<span class="st"> </span><span class="kw">mapIds</span>(<span class="dt">x =</span> org.Hs.eg.db,</a>
<a class="sourceLine" id="cb71-17" data-line-number="17">                           <span class="dt">keys=</span><span class="kw">row.names</span>(ipsc.tri.vs.di),</a>
<a class="sourceLine" id="cb71-18" data-line-number="18">                           <span class="dt">column=</span><span class="st">&quot;ENZYME&quot;</span>,</a>
<a class="sourceLine" id="cb71-19" data-line-number="19">                           <span class="dt">keytype=</span><span class="st">&quot;SYMBOL&quot;</span>,</a>
<a class="sourceLine" id="cb71-20" data-line-number="20">                           <span class="dt">multiVals=</span><span class="st">&quot;first&quot;</span>)</a></code></pre></div>
<p>Unfortunately, not all organisms offer access to such information nor is the information always complete. For instance, the following table shows the number of available records for the Ensembl, Entrez en KEGG IDs downloaded:</p>
<table style="width:61%;">
<colgroup>
<col width="22%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">ENSEMBL</th>
<th align="center">ENTREZ</th>
<th align="center">ENZYME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Available</strong></td>
<td align="center">620</td>
<td align="center">649</td>
<td align="center">60</td>
</tr>
<tr class="even">
<td align="center"><strong>Missing</strong></td>
<td align="center">208</td>
<td align="center">179</td>
<td align="center">768</td>
</tr>
</tbody>
</table>
<p>Statistics for annotation columns using AnnotationDbi</p>
<p>For other data sets you might have more luck, otherwise continue with the <code>biomaRt</code> method explained below.</p>
</div>
<div id="using-biomart" class="section level3">
<h3><span class="header-section-number">B.2.2</span> Using <code>biomaRt</code></h3>
<p>A short explanation about biomart (source: <a href="https://en.wikipedia.org/wiki/Ensembl_Genomes#BioMart">Wikipedia</a>):</p>
<blockquote>
<p>“The purpose of the BioMarts in Ensembl Genomes is to allow the user to mine and download tables containing all the genes for a single species, genes in a specific region of a chromosome or genes on one region of a chromosome associated with an InterPro domain. The BioMarts also include filters to refine the data to be extracted and the attributes (Variant ID, Chromosome name, Ensembl ID, location, etc.) that will appear in the final table file can be selected by the user.”</p>
</blockquote>
<p>The text above mentiones <em>species</em>, <em>attributes</em> and <em>filters</em>, and we need to combine these elements to query the biomart databases for our annotation. The following code ‘chunks’ show possible values for these elements and how to gather and store the relevant data.</p>
<p>The <code>biomaRt</code> library interfaces with the <a href="http://www.biomart.org">biomart.org</a> online database. Sometimes the biomart website (which offers a browsable database) is down due to maintanance, but its many mirrors can still be used, for instance at <a href="http://www.ensembl.org/biomart/martview/fc683a66d09fd1f42be754bcd90ba7da">Ensembl</a>.</p>
<p>You are required to explore a number of objects and the given example code is most likely not suitable for your data/ organism. The project is well documented on the <a href="https://bioconductor.org/packages/release/bioc/html/biomaRt.html">Bioconductor biomaRt</a> website that links to the <a href="https://bioconductor.org/packages/release/bioc/vignettes/biomaRt/inst/doc/biomaRt.html">biomaRt users guide</a>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1"><span class="co"># Load the library</span></a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="kw">library</span>(biomaRt)</a>
<a class="sourceLine" id="cb72-3" data-line-number="3"></a>
<a class="sourceLine" id="cb72-4" data-line-number="4"><span class="co"># Use an alternative database server as the regular one sometimes has issues..</span></a>
<a class="sourceLine" id="cb72-5" data-line-number="5">ensembl=<span class="kw">useMart</span>(<span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>, <span class="dt">host=</span><span class="st">&quot;www.ensembl.org&quot;</span>)</a></code></pre></div>
<table style="width:65%;">
<colgroup>
<col width="31%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">biomart</th>
<th align="center">version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ENSEMBL_MART_ENSEMBL</td>
<td align="center">Ensembl Genes 92</td>
</tr>
<tr class="even">
<td align="center">ENSEMBL_MART_MOUSE</td>
<td align="center">Mouse strains 92</td>
</tr>
<tr class="odd">
<td align="center">ENSEMBL_MART_SNP</td>
<td align="center">Ensembl Variation 92</td>
</tr>
<tr class="even">
<td align="center">ENSEMBL_MART_FUNCGEN</td>
<td align="center">Ensembl Regulation 92</td>
</tr>
</tbody>
</table>
<p>Available databases in the Ensembl biomaRt</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="co"># Select the &#39;ensembl&#39; database</span></a>
<a class="sourceLine" id="cb73-2" data-line-number="2">ensembl &lt;-<span class="st"> </span><span class="kw">useMart</span>(<span class="st">&quot;ensembl&quot;</span>)</a></code></pre></div>
<p>Using the <code>listDatasets</code> function you can get a full list of available datasets. Store this list in an R object and ‘browse’ this object in RStudio to see if your organism is included. Copy the name of the dataset, this is the <em>species</em> element we will use.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">mart.datasets &lt;-<span class="st"> </span><span class="kw">listDatasets</span>(ensembl)</a>
<a class="sourceLine" id="cb74-2" data-line-number="2"></a>
<a class="sourceLine" id="cb74-3" data-line-number="3"><span class="co"># Select the correct dataset, for the example data we select the &#39;hsapiens_gene_ensembl&#39; </span></a>
<a class="sourceLine" id="cb74-4" data-line-number="4">ensembl &lt;-<span class="st"> </span><span class="kw">useDataset</span>(<span class="st">&#39;hsapiens_gene_ensembl&#39;</span>, <span class="dt">mart =</span> ensembl)</a></code></pre></div>
<table>
<colgroup>
<col width="43%" />
<col width="43%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">dataset</th>
<th align="center">description</th>
<th align="center">version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">oanatinus_gene_ensembl</td>
<td align="center">Ornithorhynchus anatinus genes
(OANA5)</td>
<td align="center">OANA5</td>
</tr>
<tr class="even">
<td align="center">cporcellus_gene_ensembl</td>
<td align="center">Cavia porcellus genes
(cavPor3)</td>
<td align="center">cavPor3</td>
</tr>
<tr class="odd">
<td align="center">gaculeatus_gene_ensembl</td>
<td align="center">Gasterosteus aculeatus genes
(BROADS1)</td>
<td align="center">BROADS1</td>
</tr>
<tr class="even">
<td align="center">itridecemlineatus_gene_ensembl</td>
<td align="center">Ictidomys tridecemlineatus
genes (spetri2)</td>
<td align="center">spetri2</td>
</tr>
<tr class="odd">
<td align="center">lafricana_gene_ensembl</td>
<td align="center">Loxodonta africana genes
(loxAfr3)</td>
<td align="center">loxAfr3</td>
</tr>
<tr class="even">
<td align="center">choffmanni_gene_ensembl</td>
<td align="center">Choloepus hoffmanni genes
(choHof1)</td>
<td align="center">choHof1</td>
</tr>
</tbody>
</table>
<p>Subset of the 69 datasets available</p>
<p>Next is deciding on a filter. For this we can use the <code>listFilters</code> function on the <code>ensembl</code> object, storing the full list of filters. Here too it is wise to view this in RStudio to find the filter to use.</p>
<p>The filter specifies <em>what</em> you will use to search on. For instance, the <code>AnnotationDbi</code> queries above gave us <code>Ensembl</code> gene ID’s and we could use those with the <code>ensembl_gene_id</code> filter. When viewing the list of filters in RStudio you can use the search text-box in the top-right of the view, for example with <code>ensembl</code> to look for filters to use with this type of identifier.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">filters &lt;-<span class="st"> </span><span class="kw">listFilters</span>(ensembl)</a></code></pre></div>
<table style="width:96%;">
<colgroup>
<col width="52%" />
<col width="43%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">name</th>
<th align="center">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">chromosome_name</td>
<td align="center">Chromosome/scaffold name</td>
</tr>
<tr class="even">
<td align="center">start</td>
<td align="center">Start</td>
</tr>
<tr class="odd">
<td align="center">end</td>
<td align="center">End</td>
</tr>
<tr class="even">
<td align="center">band_start</td>
<td align="center">Band Start</td>
</tr>
<tr class="odd">
<td align="center">band_end</td>
<td align="center">Band End</td>
</tr>
<tr class="even">
<td align="center">marker_start</td>
<td align="center">Marker Start</td>
</tr>
<tr class="odd">
<td align="center">marker_end</td>
<td align="center">Marker End</td>
</tr>
<tr class="even">
<td align="center">encode_region</td>
<td align="center">Encode region</td>
</tr>
<tr class="odd">
<td align="center">strand</td>
<td align="center">Strand</td>
</tr>
<tr class="even">
<td align="center">chromosomal_region</td>
<td align="center">e.g. 1:100:10000:-1,
1:100000:200000:1</td>
</tr>
<tr class="odd">
<td align="center">with_ccds</td>
<td align="center">With CCDS ID(s)</td>
</tr>
<tr class="even">
<td align="center">with_chembl</td>
<td align="center">With ChEMBL ID(s)</td>
</tr>
<tr class="odd">
<td align="center">with_clone_based_ensembl_gene</td>
<td align="center">With Clone-based (Ensembl)
gene ID(s)</td>
</tr>
<tr class="even">
<td align="center">with_clone_based_ensembl_transcript</td>
<td align="center">With Clone-based (Ensembl)
transcript ID(s)</td>
</tr>
<tr class="odd">
<td align="center">with_dbass3</td>
<td align="center">With DataBase of Aberrant 3’
Splice Sites ID(s)</td>
</tr>
</tbody>
</table>
<p>Subset of the 340 available filters</p>
<p>Finally we get to the point to determine what data we would like to get from the database. These are the <code>attributes</code> which we can get with the <code>listAttributes</code> function on the <code>ensembl</code> object. Again - and especially with the attributes since there are often &gt;1000 of selectable options - we store the attributes and view them in RStudio to look for data that we want.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">attributes &lt;-<span class="st"> </span><span class="kw">listAttributes</span>(ensembl)</a></code></pre></div>
<table>
<colgroup>
<col width="40%" />
<col width="41%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">name</th>
<th align="center">description</th>
<th align="center">page</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ensembl_gene_id</td>
<td align="center">Gene stable ID</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">ensembl_gene_id_version</td>
<td align="center">Gene stable ID version</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">ensembl_transcript_id</td>
<td align="center">Transcript stable ID</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">ensembl_transcript_id_version</td>
<td align="center">Transcript stable ID version</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">ensembl_peptide_id</td>
<td align="center">Protein stable ID</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">ensembl_peptide_id_version</td>
<td align="center">Protein stable ID version</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">ensembl_exon_id</td>
<td align="center">Exon stable ID</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">description</td>
<td align="center">Gene description</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">chromosome_name</td>
<td align="center">Chromosome/scaffold name</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">start_position</td>
<td align="center">Gene start (bp)</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">end_position</td>
<td align="center">Gene end (bp)</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">strand</td>
<td align="center">Strand</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">band</td>
<td align="center">Karyotype band</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">transcript_start</td>
<td align="center">Transcript start (bp)</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">transcript_end</td>
<td align="center">Transcript end (bp)</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">transcription_start_site</td>
<td align="center">Transcription start site (TSS)</td>
<td align="center">feature_page</td>
</tr>
</tbody>
</table>
<p>Subset of the 1944 available attributes</p>
<p>If we want to have the gene chromosome, start- and end-position as well as its description (note, just as an example, there is other, more interesting information available too!) we combine this in a character vector (<code>attrs.get</code>, see below). There is one <em>caveat</em> though, the <em>order</em> in which you get back the results are <strong>not</strong> the same as the input order! This means that we cannot simple combine the data with our original data set but we need to <strong>merge</strong> it together. However, to be able to merge the data we need to know which record belongs to which gene and therefore we add our selected <code>filter</code> (in our case the <code>ensembl_gene_id</code>) to the list of attributes to get. Then, when we get the <code>results dataframe</code> we can use the <code>merge</code> function in R to combine the gene information with the actual data:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw">merge</span>(<span class="dt">x =</span> ipsc.tri.vs.di, <span class="dt">y =</span> results, <span class="dt">by.x =</span> <span class="st">&#39;Ensembl&#39;</span>, <span class="dt">by.y =</span> <span class="st">&#39;ensembl_gene_id&#39;</span>)</a></code></pre></div>
<p>We now have all three needed elements (species, filter and attributes) so we are ready to query the database with the <code>getBM</code> function (read the help using <code>?getBM</code>).</p>
<p>The example below retrieves data using a set of five Ensembl gene IDs since not all genes have an Ensembl ID as we’ve seen above, so we filter those out first and use this as the <code>values</code> parameter below.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="co"># Set the &#39;attributes&#39; values</span></a>
<a class="sourceLine" id="cb78-2" data-line-number="2">attrs.get &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ensembl_gene_id&quot;</span>, <span class="st">&quot;chromosome_name&quot;</span>, </a>
<a class="sourceLine" id="cb78-3" data-line-number="3">               <span class="st">&quot;start_position&quot;</span>,<span class="st">&quot;end_position&quot;</span>, <span class="st">&quot;description&quot;</span>)</a>
<a class="sourceLine" id="cb78-4" data-line-number="4"></a>
<a class="sourceLine" id="cb78-5" data-line-number="5"><span class="co"># Perform a biomaRt query using &#39;getBM&#39;</span></a>
<a class="sourceLine" id="cb78-6" data-line-number="6">results &lt;-<span class="st"> </span><span class="kw">getBM</span>(<span class="dt">attributes =</span> attrs.get,</a>
<a class="sourceLine" id="cb78-7" data-line-number="7">                 <span class="dt">filters =</span> <span class="st">&quot;ensembl_gene_id&quot;</span>,</a>
<a class="sourceLine" id="cb78-8" data-line-number="8">                 <span class="dt">values =</span> ipsc.tri.vs.di<span class="op">$</span>Ensembl[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], </a>
<a class="sourceLine" id="cb78-9" data-line-number="9">                 <span class="dt">mart =</span> ensembl)</a>
<a class="sourceLine" id="cb78-10" data-line-number="10"></a>
<a class="sourceLine" id="cb78-11" data-line-number="11">results<span class="op">$</span>gene_length &lt;-<span class="st"> </span><span class="kw">abs</span>(results<span class="op">$</span>end_position <span class="op">-</span><span class="st"> </span>results<span class="op">$</span>start_position)</a></code></pre></div>
<p>The <code>results</code> object is a <code>data.frame</code> with 5 columns that we can merge with our data set giving us the following annotation columns (combined from the <code>AnnotationDBI</code> and <code>biomaRt</code> libraries).</p>
<table style="width:100%;">
<colgroup>
<col width="23%" />
<col width="14%" />
<col width="14%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Ensembl</th>
<th align="center">EntrezID</th>
<th align="center">Enzyme</th>
<th align="center">chromosome_name</th>
<th align="center">start_position</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ENSG00000131969</td>
<td align="center">145447</td>
<td align="center">NA</td>
<td align="center">14</td>
<td align="center">50872160</td>
</tr>
<tr class="even">
<td align="center">ENSG00000183044</td>
<td align="center">18</td>
<td align="center">2.6.1.22</td>
<td align="center">16</td>
<td align="center">8674565</td>
</tr>
<tr class="odd">
<td align="center">ENSG00000243064</td>
<td align="center">150000</td>
<td align="center">NA</td>
<td align="center">21</td>
<td align="center">14236206</td>
</tr>
</tbody>
</table>
<p>Table continues below</p>
<table style="width:86%;">
<colgroup>
<col width="20%" />
<col width="19%" />
<col width="45%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">end_position</th>
<th align="center">gene_length</th>
<th align="center">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">50904970</td>
<td align="center">32810</td>
<td align="center">abhydrolase domain containing
12B [Source:HGNC
Symbol;Acc:HGNC:19837]</td>
</tr>
<tr class="even">
<td align="center">8784575</td>
<td align="center">110010</td>
<td align="center">4-aminobutyrate
aminotransferase [Source:HGNC
Symbol;Acc:HGNC:23]</td>
</tr>
<tr class="odd">
<td align="center">14362754</td>
<td align="center">126548</td>
<td align="center">ATP binding cassette subfamily
C member 13 (pseudogene)
[Source:HGNC
Symbol;Acc:HGNC:16022]</td>
</tr>
</tbody>
</table>
<p>This was just an example on how to use the <code>biomaRt</code> library and it comes down to selecting the correct filter and looking for interesting attributes to retrieve. Further information can be found in the documentation avaialble with `vignette(‘biomaRt’)</p>
</div>
</div>
<div id="references" class="section level2">
<h2><span class="header-section-number">B.3</span> References</h2>

<div id="refs" class="references">
<div>
<p>al., Patrick Deelen et. 2015. “Calling Genotypes from Public Rna-Sequencing Data Enables Identification of Genetic Variants That Affect Gene-Expression Levels.” <em>Genome Medicine</em> 7 (30).</p>
</div>
<div>
<p>Chen, Yunshun, Aaron Lun, Davis McCarthy, Xiaobei Zhou, Mark Robinson, and Gordon Smyth. 2018. <em>EdgeR: Empirical Analysis of Digital Gene Expression Data in R</em>. <a href="http://bioinf.wehi.edu.au/edgeR">http://bioinf.wehi.edu.au/edgeR</a>.</p>
</div>
<div>
<p>Daróczi, Gergely, and Roman Tsegelskyi. 2017. <em>Pander: An R ’Pandoc’ Writer</em>. <a href="https://CRAN.R-project.org/package=pander">https://CRAN.R-project.org/package=pander</a>.</p>
</div>
<div>
<p>Himes BE, Wagner P, Jiang X. 2014. “RNA-Seq Transcriptome Profiling Identifies Crispld2 as a Glucocorticoid Responsive Gene That Modulates Cytokine Function in Airway Smooth Muscle Cells.” <em>PLoS One</em> 9 (6).</p>
</div>
<div>
<p>Love, Michael, Simon Anders, and Wolfgang Huber. 2017. <em>DESeq2: Differential Gene Expression Analysis Based on the Negative Binomial Distribution</em>. <a href="https://github.com/mikelove/DESeq2">https://github.com/mikelove/DESeq2</a>.</p>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a1-batch-data-loading.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
