<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>B Annotating an RNA-Seq Experiment | 2.1.2 Genomics &amp; Transcriptomics</title>
  <meta name="description" content="Course Syllabus for course 2.1.2" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="B Annotating an RNA-Seq Experiment | 2.1.2 Genomics &amp; Transcriptomics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course Syllabus for course 2.1.2" />
  <meta name="github-repo" content="mkempenaar/gene_expression_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="B Annotating an RNA-Seq Experiment | 2.1.2 Genomics &amp; Transcriptomics" />
  
  <meta name="twitter:description" content="Course Syllabus for course 2.1.2" />
  

<meta name="author" content="Marcel Kempenaar" />


<meta name="date" content="2023-10-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a1-data_loading.html"/>
<link rel="next" href="a3-annotation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">2.1.2 Genomics & Transcriptomics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#genomics"><i class="fa fa-check"></i><b>1.1</b> 2.1.2 Genomics</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#project-deliverables"><i class="fa fa-check"></i><b>1.1.1</b> Project Deliverables</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#transcriptomics"><i class="fa fa-check"></i><b>1.2</b> 2.1.2 Transcriptomics</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#project-deliverables-1"><i class="fa fa-check"></i><b>1.2.1</b> Project Deliverables</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#lab-journal"><i class="fa fa-check"></i><b>1.3</b> <em>Lab Journal</em></a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.4</b> Schedule</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#genomics-1"><i class="fa fa-check"></i><b>1.4.1</b> Genomics</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#transcriptomics-1"><i class="fa fa-check"></i><b>1.4.2</b> Transcriptomics</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#literature"><i class="fa fa-check"></i><b>1.5</b> Literature</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="from-reads-to-counts.html"><a href="from-reads-to-counts.html"><i class="fa fa-check"></i><b>2</b> From Reads to Counts</a>
<ul>
<li class="chapter" data-level="2.1" data-path="from-reads-to-counts.html"><a href="from-reads-to-counts.html#downloading-and-extracting-fastq-files"><i class="fa fa-check"></i><b>2.1</b> Downloading and extracting FastQ files</a></li>
<li class="chapter" data-level="2.2" data-path="from-reads-to-counts.html"><a href="from-reads-to-counts.html#optional-annotation"><i class="fa fa-check"></i><b>2.2</b> (Optional) Annotation</a></li>
<li class="chapter" data-level="2.3" data-path="from-reads-to-counts.html"><a href="from-reads-to-counts.html#quality-control"><i class="fa fa-check"></i><b>2.3</b> Quality Control</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="from-reads-to-counts.html"><a href="from-reads-to-counts.html#fastqc"><i class="fa fa-check"></i><b>2.3.1</b> FastQC</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="from-reads-to-counts.html"><a href="from-reads-to-counts.html#trimming"><i class="fa fa-check"></i><b>2.4</b> Trimming</a></li>
<li class="chapter" data-level="2.5" data-path="from-reads-to-counts.html"><a href="from-reads-to-counts.html#mapping-with-star"><i class="fa fa-check"></i><b>2.5</b> Mapping with STAR</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="from-reads-to-counts.html"><a href="from-reads-to-counts.html#building-star-index"><i class="fa fa-check"></i><b>2.5.1</b> Building STAR index</a></li>
<li class="chapter" data-level="2.5.2" data-path="from-reads-to-counts.html"><a href="from-reads-to-counts.html#read-mapping-and-transcript-counting"><i class="fa fa-check"></i><b>2.5.2</b> Read mapping and transcript counting</a></li>
<li class="chapter" data-level="2.5.3" data-path="from-reads-to-counts.html"><a href="from-reads-to-counts.html#combining-star-count-files"><i class="fa fa-check"></i><b>2.5.3</b> Combining STAR Count Files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3.html"><a href="chapter-3.html"><i class="fa fa-check"></i><b>3</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-3.html"><a href="chapter-3.html#loading-data"><i class="fa fa-check"></i><b>3.1</b> Loading data into R</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-3.html"><a href="chapter-3.html#ch3_example_data"><i class="fa fa-check"></i><b>3.2</b> Example Data</a></li>
<li class="chapter" data-level="3.3" data-path="chapter-3.html"><a href="chapter-3.html#EDA_part1"><i class="fa fa-check"></i><b>3.3</b> Visualizing using <code>boxplot</code> and <code>density plot</code></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter-3.html"><a href="chapter-3.html#eda_statistics"><i class="fa fa-check"></i><b>3.3.1</b> Statistics</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter-3.html"><a href="chapter-3.html#eda_boxplots"><i class="fa fa-check"></i><b>3.3.2</b> Boxplots</a></li>
<li class="chapter" data-level="3.3.3" data-path="chapter-3.html"><a href="chapter-3.html#eda_density_plot"><i class="fa fa-check"></i><b>3.3.3</b> Density Plots</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter-3.html"><a href="chapter-3.html#EDA_part2"><i class="fa fa-check"></i><b>3.4</b> Visualizing using <code>heatmap</code> and <code>MDS</code></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-3.html"><a href="chapter-3.html#normalization"><i class="fa fa-check"></i><b>3.4.1</b> Normalization</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-3.html"><a href="chapter-3.html#eda_distance"><i class="fa fa-check"></i><b>3.4.2</b> Distance Calculation</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter-3.html"><a href="chapter-3.html#eda_heatmap"><i class="fa fa-check"></i><b>3.4.3</b> Sample Distances using a Heatmap</a></li>
<li class="chapter" data-level="3.4.4" data-path="chapter-3.html"><a href="chapter-3.html#eda_mds"><i class="fa fa-check"></i><b>3.4.4</b> Multi-Dimensional Scaling</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="chapter-3.html"><a href="chapter-3.html#cleaning-data"><i class="fa fa-check"></i><b>3.5</b> Cleaning Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-4.html"><a href="chapter-4.html"><i class="fa fa-check"></i><b>4</b> Discovering Differentialy Expressed Genes (DEGs)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-4.html"><a href="chapter-4.html#deg-preprocessing"><i class="fa fa-check"></i><b>4.1</b> Pre-processing</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-4.html"><a href="chapter-4.html#deg-fc"><i class="fa fa-check"></i><b>4.2</b> The <em>Fold Change</em> Value</a></li>
<li class="chapter" data-level="4.3" data-path="chapter-4.html"><a href="chapter-4.html#deg-bioconductor"><i class="fa fa-check"></i><b>4.3</b> Using Bioconductor Packages</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chapter-4.html"><a href="chapter-4.html#deg-design"><i class="fa fa-check"></i><b>4.3.1</b> The <code>Design</code> (matrix)</a></li>
<li class="chapter" data-level="4.3.2" data-path="chapter-4.html"><a href="chapter-4.html#deg-deseq2"><i class="fa fa-check"></i><b>4.3.2</b> <code>DESeq2</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="chapter-4.html"><a href="chapter-4.html#deg-edger"><i class="fa fa-check"></i><b>4.3.3</b> <code>edgeR</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-5.html"><a href="chapter-5.html"><i class="fa fa-check"></i><b>5</b> Data Analysis and Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-5.html"><a href="chapter-5.html#volcano"><i class="fa fa-check"></i><b>5.1</b> Volcano Plot</a></li>
<li class="chapter" data-level="5.2" data-path="chapter-5.html"><a href="chapter-5.html#venn-diagram"><i class="fa fa-check"></i><b>5.2</b> Venn Diagram</a></li>
<li class="chapter" data-level="5.3" data-path="chapter-5.html"><a href="chapter-5.html#clustering"><i class="fa fa-check"></i><b>5.3</b> Clustering</a></li>
<li class="chapter" data-level="5.4" data-path="chapter-5.html"><a href="chapter-5.html#pathway-analysis"><i class="fa fa-check"></i><b>5.4</b> Pathway Analysis</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chapter-5.html"><a href="chapter-5.html#gene-functional-classification-using-david-100-degs"><i class="fa fa-check"></i><b>5.4.1</b> Gene Functional Classification using DAVID (&gt;100 DEGs)</a></li>
<li class="chapter" data-level="5.4.2" data-path="chapter-5.html"><a href="chapter-5.html#kegg-pathway-visualization-10-degs"><i class="fa fa-check"></i><b>5.4.2</b> KEGG-pathway Visualization (&gt;10 DEGs)</a></li>
<li class="chapter" data-level="5.4.3" data-path="chapter-5.html"><a href="chapter-5.html#spia"><i class="fa fa-check"></i><b>5.4.3</b> Signaling Pathway Impact Analysis (&gt;20 DEGs)</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="a1-data_loading.html"><a href="a1-data_loading.html"><i class="fa fa-check"></i><b>A</b> Appendix A: Loading Expression Data in R</a>
<ul>
<li class="chapter" data-level="A.1" data-path="a1-data_loading.html"><a href="a1-data_loading.html#expl-data"><i class="fa fa-check"></i><b>A.1</b> Exploring the Available Project Data</a></li>
<li class="chapter" data-level="A.2" data-path="a1-data_loading.html"><a href="a1-data_loading.html#a1-batch_data_loading"><i class="fa fa-check"></i><b>A.2</b> Batch Loading Expression Data</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="a1-data_loading.html"><a href="a1-data_loading.html#decompressing"><i class="fa fa-check"></i><b>A.2.1</b> Decompressing</a></li>
<li class="chapter" data-level="A.2.2" data-path="a1-data_loading.html"><a href="a1-data_loading.html#determining-data-format"><i class="fa fa-check"></i><b>A.2.2</b> Determining Data Format</a></li>
<li class="chapter" data-level="A.2.3" data-path="a1-data_loading.html"><a href="a1-data_loading.html#loading-data-1"><i class="fa fa-check"></i><b>A.2.3</b> Loading Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="a2-annotation.html"><a href="a2-annotation.html"><i class="fa fa-check"></i><b>B</b> Annotating an RNA-Seq Experiment</a>
<ul>
<li class="chapter" data-level="B.1" data-path="a2-annotation.html"><a href="a2-annotation.html#download-geo"><i class="fa fa-check"></i><b>B.1</b> Downloading annotation data from GEO</a></li>
<li class="chapter" data-level="B.2" data-path="a2-annotation.html"><a href="a2-annotation.html#manually-annotate"><i class="fa fa-check"></i><b>B.2</b> Manual Data Annotation</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="a2-annotation.html"><a href="a2-annotation.html#annotationDBI"><i class="fa fa-check"></i><b>B.2.1</b> Using <code>AnnotationDBI</code></a></li>
<li class="chapter" data-level="B.2.2" data-path="a2-annotation.html"><a href="a2-annotation.html#using-biomart"><i class="fa fa-check"></i><b>B.2.2</b> Using <code>biomaRt</code></a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="a2-annotation.html"><a href="a2-annotation.html#references"><i class="fa fa-check"></i><b>B.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="a3-annotation.html"><a href="a3-annotation.html"><i class="fa fa-check"></i><b>C</b> Discovering Data Sets</a>
<ul>
<li class="chapter" data-level="C.1" data-path="a3-annotation.html"><a href="a3-annotation.html#finding-public-data"><i class="fa fa-check"></i><b>C.1</b> Finding Public Data Sets of Interest</a></li>
<li class="chapter" data-level="C.2" data-path="a3-annotation.html"><a href="a3-annotation.html#ncbi-geo"><i class="fa fa-check"></i><b>C.2</b> The NCBI <em>Gene Expression Omnibus</em></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">2.1.2 Genomics &amp; Transcriptomics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a2-annotation" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">B</span> Annotating an RNA-Seq Experiment<a href="a2-annotation.html#a2-annotation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter describes <em>annotate</em> the data, meaning assigning names and functions to our Differentially Expressed Genes. This step can either be very easy or a bit more challenging depending on the data source of your project. The first example is relevant if your data set originated from the NCBI <strong>GEO</strong>, which ‘should’ always be annotated by default. If you have found your data set elsewhere (and do not have a GEO identifier for your project), skip to the <a href="a2-annotation.html#manually-annotate">Manually annotate your data</a> section below.</p>
<p>The goal of this chapter is to - at least - find a Gene Symbol or common ID (NCBI/ Ensembl) for each gene. Using this information it will be much easier to find relevant information from other online sources to say something about the functionality and impact of your DEGs.</p>
<p>Even though you might be lucky and either already have your data or a simple GEO query results in everything you want/ need, you are tasked to <em>also</em> perform the manual annotation phase even if you will not use any of the found annotation data. Having written the code to access these sources is a good excercise in using complex Bioconductor packages. Also, you can always use this to find more information should you require this later on.</p>
<div id="download-geo" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">B.1</span> Downloading annotation data from GEO<a href="a2-annotation.html#download-geo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Given the <code>GSE****</code> id of your experiment you can download any available (annotation)data from GEO using the <code>GEOquery</code> library. For the example experiment used previously, the following code downloads two files; a <code>series_matrix.txt.gz</code> file that is also available for download from the NCBI GEO website. Note the <code>destdir</code> argument for storing it in a known location instead of the <code>/tmp</code> folder for later use.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="a2-annotation.html#cb63-1" tabindex="-1"></a><span class="fu">library</span>(GEOquery)</span>
<span id="cb63-2"><a href="a2-annotation.html#cb63-2" tabindex="-1"></a><span class="fu">getGEO</span>(<span class="at">GEO =</span> <span class="st">&#39;GSE101942&#39;</span>, <span class="at">destdir =</span> <span class="st">&quot;./data/&quot;</span>)</span></code></pre></div>
<p>Once downloaded, you can load the data using:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="a2-annotation.html#cb64-1" tabindex="-1"></a><span class="fu">library</span>(GEOquery)</span>
<span id="cb64-2"><a href="a2-annotation.html#cb64-2" tabindex="-1"></a>gse <span class="ot">&lt;-</span> <span class="fu">getGEO</span>(<span class="at">filename =</span> <span class="st">&#39;./data/GSE101942_series_matrix.txt.gz&#39;</span>)</span></code></pre></div>
<p>The <code>gse</code> object <em>may</em> contain useful information about both samples and genes. Unfortunately for this example data set there is only information available regarding the samples which we can access in the <code>phenoData</code> <strong>slot</strong>. Slots in R objects are a method of storing multiple data objects into a single R object, in this case this object is called an <code>ExpressionSet</code> (see <code>?ExpressionSet</code> for a description of its contents and structure). For storing information about an experiment this is very handy; you can store a data frame with the actual expression data, a list containing laboratory information, a chunk of text with an abstract, etc. all in a single object.</p>
<p>The most common data sets found in an <code>ExpressionSet</code> object:
* <code>@assayData</code>: the actual expression data. Most common for microarray experiments and (very) rare for RNA-seq experiments
* <code>@phenoData</code>: sample information, should be present for each GEO data set
* <code>@featureData</code>: a data frame holding feature (=gene) information, slightly rare for RNA-seq data sets
* <code>@experimentData</code>: information about the lab which performed the experiment</p>
<p>You already know how to access a column in a data frame using the <code>$</code> notation, and accessing a complete data frame in the <code>gse</code> object is done using the <code>@</code> symbol:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="a2-annotation.html#cb65-1" tabindex="-1"></a><span class="co"># Access a data frame containing phenotype information</span></span>
<span id="cb65-2"><a href="a2-annotation.html#cb65-2" tabindex="-1"></a>gse<span class="sc">@</span>phenoData<span class="sc">@</span>data</span></code></pre></div>
<p>Here you see that each sample is described using its sample identifier (<code>GSM****</code>), information about the the sample group (<code>title</code> column) and a number of characteristics. The actual information included depends on your data set.</p>
<table>
<colgroup>
<col width="22%" />
<col width="11%" />
<col width="23%" />
<col width="42%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">title</th>
<th align="center">source_name_ch1</th>
<th align="center">characteristics_ch1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>GSM2719212</strong></td>
<td align="center">C2A</td>
<td align="center">trisomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719213</strong></td>
<td align="center">C2B</td>
<td align="center">trisomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="odd">
<td align="center"><strong>GSM2719214</strong></td>
<td align="center">C2C</td>
<td align="center">trisomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719215</strong></td>
<td align="center">C244-A</td>
<td align="center">disomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="odd">
<td align="center"><strong>GSM2719216</strong></td>
<td align="center">C244-B</td>
<td align="center">disomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719217</strong></td>
<td align="center">C243</td>
<td align="center">disomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
</tbody>
</table>
<p>Contents of the <code>gse@phenoData@data</code> information (selection) (continued below)</p>
<table style="width:57%;">
<colgroup>
<col width="23%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">characteristics_ch1.1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>GSM2719212</strong></td>
<td align="center">ploidy: trisomic</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719213</strong></td>
<td align="center">ploidy: trisomic</td>
</tr>
<tr class="odd">
<td align="center"><strong>GSM2719214</strong></td>
<td align="center">ploidy: trisomic</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719215</strong></td>
<td align="center">ploidy: disomic</td>
</tr>
<tr class="odd">
<td align="center"><strong>GSM2719216</strong></td>
<td align="center">ploidy: disomic</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719217</strong></td>
<td align="center">ploidy: disomic</td>
</tr>
</tbody>
</table>
<p>If your data set has properly annotated gene information, this should be accessible in the <code>@featureData</code> slot. For instance, the data set <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE20489"><code>GSE20489</code></a> does have this annotation available. Once loaded, we see that the following annotation columns are present for <em>each gene</em> in the <code>featureData</code> slot (following is a small subset, in total there can be well over 20 columns of information per gene). Also, the <em>metadata</em> listing shows for how many features (=genes, 54675) and samples (54) the expression data is present (in the <code>@assayData</code> slot):</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="a2-annotation.html#cb66-1" tabindex="-1"></a><span class="co"># This gets a list with a single &#39;ExpressionSet&#39; object</span></span>
<span id="cb66-2"><a href="a2-annotation.html#cb66-2" tabindex="-1"></a>GSE20489 <span class="ot">&lt;-</span> <span class="fu">getGEO</span>(<span class="at">GEO =</span> <span class="st">&quot;GSE20489&quot;</span>, <span class="at">destdir =</span> <span class="st">&#39;./data&#39;</span>)</span>
<span id="cb66-3"><a href="a2-annotation.html#cb66-3" tabindex="-1"></a><span class="co"># Print some metadata of the featureData slot</span></span>
<span id="cb66-4"><a href="a2-annotation.html#cb66-4" tabindex="-1"></a>GSE20489[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## ExpressionSet (storageMode: lockedEnvironment)
## assayData: 54675 features, 54 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: GSM514737 GSM514738 ... GSM514790 (54 total)
##   varLabels: title geo_accession ... tissue:ch1 (39 total)
##   varMetadata: labelDescription
## featureData
##   featureNames: 1007_s_at 1053_at ... AFFX-TrpnX-M_at (54675 total)
##   fvarLabels: ID GB_ACC ... Gene Ontology Molecular Function (16 total)
##   fvarMetadata: Column Description labelDescription
## experimentData: use &#39;experimentData(object)&#39;
##   pubMedIds: 23883607 
## Annotation: GPL570</code></pre>
<table>
<colgroup>
<col width="15%" />
<col width="35%" />
<col width="23%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">ID</th>
<th align="center">Gene Title</th>
<th align="center">Gene Symbol</th>
<th align="center">ENTREZ_GENE_ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1007_s_at</td>
<td align="center">discoidin domain receptor
tyrosine kinase …</td>
<td align="center">DDR1 /// MIR4640</td>
<td align="center">780 /// 100616237</td>
</tr>
<tr class="even">
<td align="center">1053_at</td>
<td align="center">replication factor C
(activator 1) 2, 40kDa</td>
<td align="center">RFC2</td>
<td align="center">5982</td>
</tr>
<tr class="odd">
<td align="center">117_at</td>
<td align="center">heat shock 70kDa protein
6 (HSP70B’)</td>
<td align="center">HSPA6</td>
<td align="center">3310</td>
</tr>
<tr class="even">
<td align="center">121_at</td>
<td align="center">paired box 8</td>
<td align="center">PAX8</td>
<td align="center">7849</td>
</tr>
<tr class="odd">
<td align="center">1255_g_at</td>
<td align="center">guanylate cyclase
activator 1A (retina)</td>
<td align="center">GUCA1A</td>
<td align="center">2978</td>
</tr>
<tr class="even">
<td align="center">1294_at</td>
<td align="center">microRNA 5193 ///
ubiquitin-like modifier
…</td>
<td align="center">MIR5193 /// UBA7</td>
<td align="center">7318 /// 100847079</td>
</tr>
</tbody>
</table>
<p>Gene information stored in an <code>ExpressionSet</code> object for experiment GSE20489 (continued below)</p>
<table style="width:39%;">
<colgroup>
<col width="38%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Gene Ontology Biological
Process</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0001558 // regulation of
cell growth // in…</td>
</tr>
<tr class="even">
<td align="center">0000278 // mitotic cell
cycle // traceable…</td>
</tr>
<tr class="odd">
<td align="center">0000902 // cell
morphogenesis // inferred
…</td>
</tr>
<tr class="even">
<td align="center">0001655 // urogenital
system development /…</td>
</tr>
<tr class="odd">
<td align="center">0007165 // signal
transduction //
non-trac…</td>
</tr>
<tr class="even">
<td align="center">0006464 // cellular
protein modification p…</td>
</tr>
</tbody>
</table>
</div>
<div id="manually-annotate" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">B.2</span> Manual Data Annotation<a href="a2-annotation.html#manually-annotate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Luckily for us, R offers a number of libraries to automatically retrieve information for large sets of genes, unless you have chosen an organism for which not much data is available. This section demonstrates the use of two such libraries, starting with <code>AnnotationDbi</code> followed by <code>biomaRt</code>.</p>
<p>The <code>AnnotationDbi</code> library downloads a local copy of an organism-specific database with gene information where <code>biomaRt</code> uses online databases to retrieve data given a <code>query</code>. <code>biomaRt</code> offers far more data (over 1000 data fields per organism) but is more complex to use.</p>
<p>Since <code>biomaRt</code> is also relying on online databases it might be a good strategy to annotate only the genes of interest (the DEGs) instead of querying for &gt;20.000 genes while we might only retain 20 after statistical analysis. If you are planning to use <code>biomaRt</code>, skip to the <a href="#discover-degs">Discovering Differentialy Expressed Genes (DEGs)</a> chapter first and then return to the <span id="using-biomart">Using R Bioconductors <code>biomaRt</code></span> section to annotate the data.</p>
<div id="annotationDBI" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">B.2.1</span> Using <code>AnnotationDBI</code><a href="a2-annotation.html#annotationDBI" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>AnnotationDbi</code> offers data sets for many organisms in the form of installable libraries and depending on your experiment you need to find the proper library. The example experiment contains samples of the house mouse (Mus musculus) and therefore we select its data set.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="a2-annotation.html#cb68-1" tabindex="-1"></a><span class="co"># Load the AnnotationDbi interface library</span></span>
<span id="cb68-2"><a href="a2-annotation.html#cb68-2" tabindex="-1"></a><span class="fu">library</span>(AnnotationDbi)</span>
<span id="cb68-3"><a href="a2-annotation.html#cb68-3" tabindex="-1"></a><span class="co"># Load the Bioconductor installation library (contains &#39;biocLite()&#39;)</span></span>
<span id="cb68-4"><a href="a2-annotation.html#cb68-4" tabindex="-1"></a><span class="fu">library</span>(BiocInstaller)</span>
<span id="cb68-5"><a href="a2-annotation.html#cb68-5" tabindex="-1"></a></span>
<span id="cb68-6"><a href="a2-annotation.html#cb68-6" tabindex="-1"></a><span class="co"># Install and load the organism specific gene database</span></span>
<span id="cb68-7"><a href="a2-annotation.html#cb68-7" tabindex="-1"></a><span class="co"># &#39;org&#39; for Organism</span></span>
<span id="cb68-8"><a href="a2-annotation.html#cb68-8" tabindex="-1"></a><span class="co"># &#39;Hs&#39; for Homo sapiens</span></span>
<span id="cb68-9"><a href="a2-annotation.html#cb68-9" tabindex="-1"></a><span class="co"># &#39;eg&#39; for Entrez Gene IDs</span></span>
<span id="cb68-10"><a href="a2-annotation.html#cb68-10" tabindex="-1"></a><span class="co"># (try to load (using the library function) first before installing, it might already be present)</span></span>
<span id="cb68-11"><a href="a2-annotation.html#cb68-11" tabindex="-1"></a><span class="fu">biocLite</span>(<span class="st">&#39;org.Hs.eg.db&#39;</span>)</span>
<span id="cb68-12"><a href="a2-annotation.html#cb68-12" tabindex="-1"></a><span class="fu">library</span>(org.Hs.eg.db)</span></code></pre></div>
<p>The following information types are available in this database (use the <code>columns</code> function to inspect).</p>
<table style="width:88%;">
<colgroup>
<col width="20%" />
<col width="19%" />
<col width="19%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Columns</th>
<th align="center">Columns</th>
<th align="center">Columns</th>
<th align="center">Columns</th>
<th align="center">Columns</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ACCNUM</td>
<td align="center">ENZYME</td>
<td align="center">GOALL</td>
<td align="center">PATH</td>
<td align="center">UCSCKG</td>
</tr>
<tr class="even">
<td align="center">ALIAS</td>
<td align="center">EVIDENCE</td>
<td align="center">IPI</td>
<td align="center">PFAM</td>
<td align="center">UNIPROT</td>
</tr>
<tr class="odd">
<td align="center">ENSEMBL</td>
<td align="center">EVIDENCEALL</td>
<td align="center">MAP</td>
<td align="center">PMID</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">ENSEMBLPROT</td>
<td align="center">GENENAME</td>
<td align="center">OMIM</td>
<td align="center">PROSITE</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">ENSEMBLTRANS</td>
<td align="center">GENETYPE</td>
<td align="center">ONTOLOGY</td>
<td align="center">REFSEQ</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">ENTREZID</td>
<td align="center">GO</td>
<td align="center">ONTOLOGYALL</td>
<td align="center">SYMBOL</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Available fields in the database</p>
<p>The table below shows the data available for all information types given a randomly chosen <a href="http://www.ncbi.nlm.nih.gov/gene/1080"><em>EntrezID</em> of ‘1080’</a>. Note that the table has been split to show the 24 data types with their values.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="a2-annotation.html#cb69-1" tabindex="-1"></a>.Hs.data.table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(.Hs.data[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,], .Hs.data[<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>,])</span>
<span id="cb69-2"><a href="a2-annotation.html#cb69-2" tabindex="-1"></a><span class="fu">colnames</span>(.Hs.data.table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Data Type&#39;</span>, <span class="st">&#39;Example Value&#39;</span>,</span>
<span id="cb69-3"><a href="a2-annotation.html#cb69-3" tabindex="-1"></a>                              <span class="st">&#39;Data Type&#39;</span>, <span class="st">&#39;Example Value&#39;</span>)</span>
<span id="cb69-4"><a href="a2-annotation.html#cb69-4" tabindex="-1"></a><span class="fu">pander</span>(.Hs.data.table, <span class="at">caption=</span><span class="st">&quot;Example values for each field in &#39;org.Hs.eg.db&#39;&quot;</span>)</span></code></pre></div>
<table>
<colgroup>
<col width="19%" />
<col width="40%" />
<col width="18%" />
<col width="21%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Data Type</th>
<th align="center">Example Value</th>
<th align="center">Data Type</th>
<th align="center">Example Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ACCNUM</td>
<td align="center">AAA35680</td>
<td align="center">GOALL</td>
<td align="center"><a href="GO:0000003" class="uri">GO:0000003</a></td>
</tr>
<tr class="even">
<td align="center">ALIAS</td>
<td align="center">ABC35</td>
<td align="center">IPI</td>
<td align="center">IPI00816721</td>
</tr>
<tr class="odd">
<td align="center">ENSEMBL</td>
<td align="center">ENSG00000001626</td>
<td align="center">MAP</td>
<td align="center">7q31.2</td>
</tr>
<tr class="even">
<td align="center">ENSEMBLPROT</td>
<td align="center">NA</td>
<td align="center">OMIM</td>
<td align="center">167800</td>
</tr>
<tr class="odd">
<td align="center">ENSEMBLTRANS</td>
<td align="center">NA</td>
<td align="center">ONTOLOGY</td>
<td align="center">MF</td>
</tr>
<tr class="even">
<td align="center">ENTREZID</td>
<td align="center">NA</td>
<td align="center">ONTOLOGYALL</td>
<td align="center">BP</td>
</tr>
<tr class="odd">
<td align="center">ENZYME</td>
<td align="center">3.6.3.49</td>
<td align="center">PATH</td>
<td align="center">02010</td>
</tr>
<tr class="even">
<td align="center">EVIDENCE</td>
<td align="center">IDA</td>
<td align="center">PFAM</td>
<td align="center">PF00664</td>
</tr>
<tr class="odd">
<td align="center">EVIDENCEALL</td>
<td align="center">ISS</td>
<td align="center">PMID</td>
<td align="center">1284466</td>
</tr>
<tr class="even">
<td align="center">GENENAME</td>
<td align="center">CF transmembrane conductance
regulator</td>
<td align="center">PROSITE</td>
<td align="center">PS50893</td>
</tr>
<tr class="odd">
<td align="center">GENETYPE</td>
<td align="center">protein-coding</td>
<td align="center">REFSEQ</td>
<td align="center">NM_000492</td>
</tr>
<tr class="even">
<td align="center">GO</td>
<td align="center"><a href="GO:0005254" class="uri">GO:0005254</a></td>
<td align="center">SYMBOL</td>
<td align="center">CFTR</td>
</tr>
</tbody>
</table>
<p>Example values for each field in ‘org.Hs.eg.db’</p>
<p>Retrieving data from the locally stored annotation database can be done using the <code>mapIds</code> function which takes a number of arguments:</p>
<ul>
<li><strong><code>x</code></strong>: the local database to query</li>
<li><strong><code>keys</code></strong>: the IDs from your <em>own</em> data set, most often you have <code>ENSEMBL</code> IDs or gene <code>SYMBOLS</code>. In the example data the <code>rownames</code> of the data set contain the gene <code>SYMBOLS</code> (see Table 1 on page 2)</li>
<li><strong><code>column</code></strong>: the data column to <em>retrieve</em> from the database</li>
<li><strong><code>keytype</code></strong>: the type of data that you <em>provide</em>. In the example data this is a gene <code>SYMBOL</code></li>
<li><strong><code>multiVals</code></strong>: a number of columns contain more then one entry for a single gene, in that case we only want to store the first one.</li>
</ul>
<p>The output of the <code>mapIds</code> function is a single character vector that we can add to our data frame containing the DEGs (in this case the DEGs for the IPSC trisomic vs disomic comparison containing 828 genes stored in the <code>ipsc.tri.vs.di</code> data frame).</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="a2-annotation.html#cb70-1" tabindex="-1"></a><span class="co"># Retrieve the ENSEMBL gene ID, e.g. &#39;ENSG00000001626&#39;</span></span>
<span id="cb70-2"><a href="a2-annotation.html#cb70-2" tabindex="-1"></a>ipsc.tri.vs.di<span class="sc">$</span>Ensembl <span class="ot">&lt;-</span> <span class="fu">mapIds</span>(<span class="at">x =</span> org.Hs.eg.db,</span>
<span id="cb70-3"><a href="a2-annotation.html#cb70-3" tabindex="-1"></a>                           <span class="at">keys=</span><span class="fu">row.names</span>(ipsc.tri.vs.di),</span>
<span id="cb70-4"><a href="a2-annotation.html#cb70-4" tabindex="-1"></a>                           <span class="at">column=</span><span class="st">&quot;ENSEMBL&quot;</span>,</span>
<span id="cb70-5"><a href="a2-annotation.html#cb70-5" tabindex="-1"></a>                           <span class="at">keytype=</span><span class="st">&quot;SYMBOL&quot;</span>,</span>
<span id="cb70-6"><a href="a2-annotation.html#cb70-6" tabindex="-1"></a>                           <span class="at">multiVals=</span><span class="st">&quot;first&quot;</span>)</span>
<span id="cb70-7"><a href="a2-annotation.html#cb70-7" tabindex="-1"></a></span>
<span id="cb70-8"><a href="a2-annotation.html#cb70-8" tabindex="-1"></a><span class="co"># Retrieve the ENTREZ gene ID, e.g. &#39;12323&#39;</span></span>
<span id="cb70-9"><a href="a2-annotation.html#cb70-9" tabindex="-1"></a>ipsc.tri.vs.di<span class="sc">$</span>EntrezID <span class="ot">&lt;-</span> <span class="fu">mapIds</span>(<span class="at">x =</span> org.Hs.eg.db,</span>
<span id="cb70-10"><a href="a2-annotation.html#cb70-10" tabindex="-1"></a>                            <span class="at">keys=</span><span class="fu">row.names</span>(ipsc.tri.vs.di),</span>
<span id="cb70-11"><a href="a2-annotation.html#cb70-11" tabindex="-1"></a>                            <span class="at">column=</span><span class="st">&quot;ENTREZID&quot;</span>,</span>
<span id="cb70-12"><a href="a2-annotation.html#cb70-12" tabindex="-1"></a>                            <span class="at">keytype=</span><span class="st">&quot;SYMBOL&quot;</span>,</span>
<span id="cb70-13"><a href="a2-annotation.html#cb70-13" tabindex="-1"></a>                            <span class="at">multiVals=</span><span class="st">&quot;first&quot;</span>)</span>
<span id="cb70-14"><a href="a2-annotation.html#cb70-14" tabindex="-1"></a></span>
<span id="cb70-15"><a href="a2-annotation.html#cb70-15" tabindex="-1"></a><span class="co"># Retrieve the KEGG enzyme code, e.g. 2.7.11.17</span></span>
<span id="cb70-16"><a href="a2-annotation.html#cb70-16" tabindex="-1"></a>ipsc.tri.vs.di<span class="sc">$</span>Enzyme <span class="ot">&lt;-</span> <span class="fu">mapIds</span>(<span class="at">x =</span> org.Hs.eg.db,</span>
<span id="cb70-17"><a href="a2-annotation.html#cb70-17" tabindex="-1"></a>                           <span class="at">keys=</span><span class="fu">row.names</span>(ipsc.tri.vs.di),</span>
<span id="cb70-18"><a href="a2-annotation.html#cb70-18" tabindex="-1"></a>                           <span class="at">column=</span><span class="st">&quot;ENZYME&quot;</span>,</span>
<span id="cb70-19"><a href="a2-annotation.html#cb70-19" tabindex="-1"></a>                           <span class="at">keytype=</span><span class="st">&quot;SYMBOL&quot;</span>,</span>
<span id="cb70-20"><a href="a2-annotation.html#cb70-20" tabindex="-1"></a>                           <span class="at">multiVals=</span><span class="st">&quot;first&quot;</span>)</span></code></pre></div>
<p>Unfortunately, not all organisms offer access to such information nor is the information always complete. For instance, the following table shows the number of available records for the Ensembl, Entrez en KEGG IDs downloaded:</p>
<table style="width:61%;">
<colgroup>
<col width="22%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">ENSEMBL</th>
<th align="center">ENTREZ</th>
<th align="center">ENZYME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Available</strong></td>
<td align="center">632</td>
<td align="center">650</td>
<td align="center">62</td>
</tr>
<tr class="even">
<td align="center"><strong>Missing</strong></td>
<td align="center">217</td>
<td align="center">199</td>
<td align="center">787</td>
</tr>
</tbody>
</table>
<p>Statistics for annotation columns using AnnotationDbi</p>
<p>For other data sets you might have more luck, otherwise continue with the <code>biomaRt</code> method explained below.</p>
</div>
<div id="using-biomart" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">B.2.2</span> Using <code>biomaRt</code><a href="a2-annotation.html#using-biomart" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A short explanation about biomart (source: <a href="https://en.wikipedia.org/wiki/Ensembl_Genomes#BioMart">Wikipedia</a>):</p>
<blockquote>
<p>“The purpose of the BioMarts in Ensembl Genomes is to allow the user to mine and download tables containing all the genes for a single species, genes in a specific region of a chromosome or genes on one region of a chromosome associated with an InterPro domain. The BioMarts also include filters to refine the data to be extracted and the attributes (Variant ID, Chromosome name, Ensembl ID, location, etc.) that will appear in the final table file can be selected by the user.”</p>
</blockquote>
<p>The text above mentiones <em>species</em>, <em>attributes</em> and <em>filters</em>, and we need to combine these elements to query the biomart databases for our annotation. The following code ‘chunks’ show possible values for these elements and how to gather and store the relevant data.</p>
<p>The <code>biomaRt</code> library interfaces with the <a href="http://www.biomart.org">biomart.org</a> online database. Sometimes the biomart website (which offers a browsable database) is down due to maintenance, but its many mirrors can still be used, for instance at <a href="http://www.ensembl.org/biomart/martview/fc683a66d09fd1f42be754bcd90ba7da">Ensembl</a>.</p>
<p>You are required to explore a number of objects and the given example code is most likely not suitable for your data/ organism. The project is well documented on the <a href="https://bioconductor.org/packages/release/bioc/html/biomaRt.html">Bioconductor biomaRt</a> website that links to the <a href="https://bioconductor.org/packages/release/bioc/vignettes/biomaRt/inst/doc/biomaRt.html">biomaRt users guide</a>.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="a2-annotation.html#cb71-1" tabindex="-1"></a><span class="co"># Load the library</span></span>
<span id="cb71-2"><a href="a2-annotation.html#cb71-2" tabindex="-1"></a><span class="fu">library</span>(biomaRt)</span>
<span id="cb71-3"><a href="a2-annotation.html#cb71-3" tabindex="-1"></a></span>
<span id="cb71-4"><a href="a2-annotation.html#cb71-4" tabindex="-1"></a><span class="co"># Use an alternative database server as the regular one sometimes has issues..</span></span>
<span id="cb71-5"><a href="a2-annotation.html#cb71-5" tabindex="-1"></a>ensembl<span class="ot">=</span><span class="fu">useMart</span>(<span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>, <span class="at">host=</span><span class="st">&quot;https://www.ensembl.org&quot;</span>)</span></code></pre></div>
<table style="width:67%;">
<colgroup>
<col width="31%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">biomart</th>
<th align="center">version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ENSEMBL_MART_ENSEMBL</td>
<td align="center">Ensembl Genes 105</td>
</tr>
<tr class="even">
<td align="center">ENSEMBL_MART_MOUSE</td>
<td align="center">Mouse strains 105</td>
</tr>
<tr class="odd">
<td align="center">ENSEMBL_MART_SNP</td>
<td align="center">Ensembl Variation 105</td>
</tr>
<tr class="even">
<td align="center">ENSEMBL_MART_FUNCGEN</td>
<td align="center">Ensembl Regulation 105</td>
</tr>
</tbody>
</table>
<p>Available databases in the Ensembl biomaRt</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="a2-annotation.html#cb72-1" tabindex="-1"></a><span class="co"># Select the &#39;ensembl&#39; database</span></span>
<span id="cb72-2"><a href="a2-annotation.html#cb72-2" tabindex="-1"></a>ensembl <span class="ot">&lt;-</span> <span class="fu">useMart</span>(<span class="st">&quot;ensembl&quot;</span>)</span></code></pre></div>
<p>Using the <code>listDatasets</code> function you can get a full list of available datasets. Store this list in an R object and ‘browse’ this object in RStudio to see if your organism is included. Copy the name of the dataset, this is the <em>species</em> element we will use.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="a2-annotation.html#cb73-1" tabindex="-1"></a>mart.datasets <span class="ot">&lt;-</span> <span class="fu">listDatasets</span>(ensembl)</span>
<span id="cb73-2"><a href="a2-annotation.html#cb73-2" tabindex="-1"></a></span>
<span id="cb73-3"><a href="a2-annotation.html#cb73-3" tabindex="-1"></a><span class="co"># Select the correct dataset, for the example data we select the &#39;hsapiens_gene_ensembl&#39; </span></span>
<span id="cb73-4"><a href="a2-annotation.html#cb73-4" tabindex="-1"></a>ensembl <span class="ot">&lt;-</span> <span class="fu">useDataset</span>(<span class="st">&#39;hsapiens_gene_ensembl&#39;</span>, <span class="at">mart =</span> ensembl)</span></code></pre></div>
<table>
<colgroup>
<col width="39%" />
<col width="42%" />
<col width="17%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">dataset</th>
<th align="center">description</th>
<th align="center">version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">abrachyrhynchus_gene_ensembl</td>
<td align="center">Pink-footed goose genes
(ASM259213v1)</td>
<td align="center">ASM259213v1</td>
</tr>
<tr class="even">
<td align="center">acalliptera_gene_ensembl</td>
<td align="center">Eastern happy genes
(fAstCal1.2)</td>
<td align="center">fAstCal1.2</td>
</tr>
<tr class="odd">
<td align="center">acarolinensis_gene_ensembl</td>
<td align="center">Green anole genes
(AnoCar2.0v2)</td>
<td align="center">AnoCar2.0v2</td>
</tr>
<tr class="even">
<td align="center">acchrysaetos_gene_ensembl</td>
<td align="center">Golden eagle genes
(bAquChr1.2)</td>
<td align="center">bAquChr1.2</td>
</tr>
<tr class="odd">
<td align="center">acitrinellus_gene_ensembl</td>
<td align="center">Midas cichlid genes (Midas_v5)</td>
<td align="center">Midas_v5</td>
</tr>
<tr class="even">
<td align="center">amelanoleuca_gene_ensembl</td>
<td align="center">Giant panda genes
(ASM200744v2)</td>
<td align="center">ASM200744v2</td>
</tr>
</tbody>
</table>
<p>Subset of the 214 datasets available</p>
<p>Next is deciding on a filter. For this we can use the <code>listFilters</code> function on the <code>ensembl</code> object, storing the full list of filters. Here too it is wise to view this in RStudio to find the filter to use.</p>
<p>The filter specifies <em>what</em> you will use to search on. For instance, the <code>AnnotationDbi</code> queries above gave us <code>Ensembl</code> gene ID’s and we could use those with the <code>ensembl_gene_id</code> filter. When viewing the list of filters in RStudio you can use the search text-box in the top-right of the view, for example with <code>ensembl</code> to look for filters to use with this type of identifier.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="a2-annotation.html#cb74-1" tabindex="-1"></a>filters <span class="ot">&lt;-</span> <span class="fu">listFilters</span>(ensembl)</span></code></pre></div>
<table style="width:86%;">
<colgroup>
<col width="40%" />
<col width="45%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">name</th>
<th align="center">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">chromosome_name</td>
<td align="center">Chromosome/scaffold name</td>
</tr>
<tr class="even">
<td align="center">start</td>
<td align="center">Start</td>
</tr>
<tr class="odd">
<td align="center">end</td>
<td align="center">End</td>
</tr>
<tr class="even">
<td align="center">strand</td>
<td align="center">Strand</td>
</tr>
<tr class="odd">
<td align="center">chromosomal_region</td>
<td align="center">e.g. 1:100:10000:-1,
1:100000:200000:1</td>
</tr>
<tr class="even">
<td align="center">with_biogrid</td>
<td align="center">With BioGRID Interaction data,
The General Repository for
Interaction Datasets ID(s)</td>
</tr>
<tr class="odd">
<td align="center">with_ccds</td>
<td align="center">With CCDS ID(s)</td>
</tr>
<tr class="even">
<td align="center">with_chembl</td>
<td align="center">With ChEMBL ID(s)</td>
</tr>
<tr class="odd">
<td align="center">with_dbass3</td>
<td align="center">With DataBase of Aberrant 3’
Splice Sites ID(s)</td>
</tr>
<tr class="even">
<td align="center">with_dbass5</td>
<td align="center">With DataBase of Aberrant 5’
Splice Sites ID(s)</td>
</tr>
<tr class="odd">
<td align="center">with_ens_hs_transcript</td>
<td align="center">With Ensembl Human Transcript
ID(s)</td>
</tr>
<tr class="even">
<td align="center">with_ens_hs_translation</td>
<td align="center">With Ensembl Human Translation
ID(s)</td>
</tr>
<tr class="odd">
<td align="center">with_entrezgene_trans_name</td>
<td align="center">With EntrezGene transcript
name ID(s)</td>
</tr>
<tr class="even">
<td align="center">with_embl</td>
<td align="center">With European Nucleotide
Archive ID(s)</td>
</tr>
<tr class="odd">
<td align="center">with_arrayexpress</td>
<td align="center">With Expression Atlas ID(s)</td>
</tr>
</tbody>
</table>
<p>Subset of the 439 available filters</p>
<p>Finally we get to the point to determine what data we would like to get from the database. These are the <code>attributes</code> which we can get with the <code>listAttributes</code> function on the <code>ensembl</code> object. Again - and especially with the attributes since there are often &gt;1000 of selectable options - we store the attributes and view them in RStudio to look for data that we want.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="a2-annotation.html#cb75-1" tabindex="-1"></a>attributes <span class="ot">&lt;-</span> <span class="fu">listAttributes</span>(ensembl)</span></code></pre></div>
<table>
<colgroup>
<col width="40%" />
<col width="41%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">name</th>
<th align="center">description</th>
<th align="center">page</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ensembl_gene_id</td>
<td align="center">Gene stable ID</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">ensembl_gene_id_version</td>
<td align="center">Gene stable ID version</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">ensembl_transcript_id</td>
<td align="center">Transcript stable ID</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">ensembl_transcript_id_version</td>
<td align="center">Transcript stable ID version</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">ensembl_peptide_id</td>
<td align="center">Protein stable ID</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">ensembl_peptide_id_version</td>
<td align="center">Protein stable ID version</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">ensembl_exon_id</td>
<td align="center">Exon stable ID</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">description</td>
<td align="center">Gene description</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">chromosome_name</td>
<td align="center">Chromosome/scaffold name</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">start_position</td>
<td align="center">Gene start (bp)</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">end_position</td>
<td align="center">Gene end (bp)</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">strand</td>
<td align="center">Strand</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">band</td>
<td align="center">Karyotype band</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">transcript_start</td>
<td align="center">Transcript start (bp)</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">transcript_end</td>
<td align="center">Transcript end (bp)</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">transcription_start_site</td>
<td align="center">Transcription start site (TSS)</td>
<td align="center">feature_page</td>
</tr>
</tbody>
</table>
<p>Subset of the 3143 available attributes</p>
<p>If we want to have the gene chromosome, start- and end-position as well as its description (note, just as an example, there is other, more interesting information available too!) we combine this in a character vector (<code>attrs.get</code>, see below). There is one <em>caveat</em> though, the <em>order</em> in which you get back the results are <strong>not</strong> the same as the input order! This means that we cannot simple combine the data with our original data set but we need to <strong>merge</strong> it together. However, to be able to merge the data we need to know which record belongs to which gene and therefore we add our selected <code>filter</code> (in our case the <code>ensembl_gene_id</code>) to the list of attributes to get. Then, when we get the <code>results dataframe</code> we can use the <code>merge</code> function in R to combine the gene information with the actual data:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="a2-annotation.html#cb76-1" tabindex="-1"></a><span class="fu">merge</span>(<span class="at">x =</span> ipsc.tri.vs.di, <span class="at">y =</span> results, <span class="at">by.x =</span> <span class="st">&#39;Ensembl&#39;</span>, <span class="at">by.y =</span> <span class="st">&#39;ensembl_gene_id&#39;</span>)</span></code></pre></div>
<p>We now have all three needed elements (species, filter and attributes) so we are ready to query the database with the <code>getBM</code> function (read the help using <code>?getBM</code>).</p>
<p>The example below retrieves data using a set of five Ensembl gene IDs since not all genes have an Ensembl ID as we’ve seen above, so we filter those out first and use this as the <code>values</code> parameter below.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="a2-annotation.html#cb77-1" tabindex="-1"></a><span class="co"># Set the &#39;attributes&#39; values</span></span>
<span id="cb77-2"><a href="a2-annotation.html#cb77-2" tabindex="-1"></a>attrs.get <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ensembl_gene_id&quot;</span>, <span class="st">&quot;chromosome_name&quot;</span>, </span>
<span id="cb77-3"><a href="a2-annotation.html#cb77-3" tabindex="-1"></a>               <span class="st">&quot;start_position&quot;</span>,<span class="st">&quot;end_position&quot;</span>, <span class="st">&quot;description&quot;</span>)</span>
<span id="cb77-4"><a href="a2-annotation.html#cb77-4" tabindex="-1"></a></span>
<span id="cb77-5"><a href="a2-annotation.html#cb77-5" tabindex="-1"></a><span class="co"># Perform a biomaRt query using &#39;getBM&#39;</span></span>
<span id="cb77-6"><a href="a2-annotation.html#cb77-6" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">getBM</span>(<span class="at">attributes =</span> attrs.get,</span>
<span id="cb77-7"><a href="a2-annotation.html#cb77-7" tabindex="-1"></a>                 <span class="at">filters =</span> <span class="st">&quot;ensembl_gene_id&quot;</span>,</span>
<span id="cb77-8"><a href="a2-annotation.html#cb77-8" tabindex="-1"></a>                 <span class="at">values =</span> ipsc.tri.vs.di<span class="sc">$</span>Ensembl[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], </span>
<span id="cb77-9"><a href="a2-annotation.html#cb77-9" tabindex="-1"></a>                 <span class="at">mart =</span> ensembl)</span>
<span id="cb77-10"><a href="a2-annotation.html#cb77-10" tabindex="-1"></a></span>
<span id="cb77-11"><a href="a2-annotation.html#cb77-11" tabindex="-1"></a>results<span class="sc">$</span>gene_length <span class="ot">&lt;-</span> <span class="fu">abs</span>(results<span class="sc">$</span>end_position <span class="sc">-</span> results<span class="sc">$</span>start_position)</span></code></pre></div>
<p>The <code>results</code> object is a <code>data.frame</code> with 5 columns that we can merge with our data set giving us the following annotation columns (combined from the <code>AnnotationDBI</code> and <code>biomaRt</code> libraries).</p>
<table style="width:100%;">
<colgroup>
<col width="23%" />
<col width="14%" />
<col width="14%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Ensembl</th>
<th align="center">EntrezID</th>
<th align="center">Enzyme</th>
<th align="center">chromosome_name</th>
<th align="center">start_position</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ENSG00000131969</td>
<td align="center">145447</td>
<td align="center">NA</td>
<td align="center">14</td>
<td align="center">50872053</td>
</tr>
<tr class="even">
<td align="center">ENSG00000183044</td>
<td align="center">18</td>
<td align="center">2.6.1.22</td>
<td align="center">16</td>
<td align="center">8674596</td>
</tr>
<tr class="odd">
<td align="center">ENSG00000243064</td>
<td align="center">150000</td>
<td align="center">NA</td>
<td align="center">21</td>
<td align="center">14236206</td>
</tr>
</tbody>
</table>
<p>Table continues below</p>
<table style="width:86%;">
<colgroup>
<col width="20%" />
<col width="19%" />
<col width="45%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">end_position</th>
<th align="center">gene_length</th>
<th align="center">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">50904970</td>
<td align="center">32917</td>
<td align="center">abhydrolase domain containing
12B [Source:HGNC
Symbol;Acc:HGNC:19837]</td>
</tr>
<tr class="even">
<td align="center">8784575</td>
<td align="center">109979</td>
<td align="center">4-aminobutyrate
aminotransferase [Source:HGNC
Symbol;Acc:HGNC:23]</td>
</tr>
<tr class="odd">
<td align="center">14362754</td>
<td align="center">126548</td>
<td align="center">ATP binding cassette subfamily
C member 13 (pseudogene)
[Source:HGNC
Symbol;Acc:HGNC:16022]</td>
</tr>
</tbody>
</table>
<p>This was just an example on how to use the <code>biomaRt</code> library and it comes down to selecting the correct filter and looking for interesting attributes to retrieve. Further information can be found in the documentation avaialble with `vignette(‘biomaRt’)</p>
</div>
</div>
<div id="references" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">B.3</span> References<a href="a2-annotation.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a1-data_loading.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a3-annotation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
