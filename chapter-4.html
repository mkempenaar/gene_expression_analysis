<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> Discovering Differentialy Expressed Genes (DEGs) | Analysis of Gene Expression</title>
  <meta name="description" content="Course Syllabus for BFV: Theme 07 course" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content=" Discovering Differentialy Expressed Genes (DEGs) | Analysis of Gene Expression" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course Syllabus for BFV: Theme 07 course" />
  <meta name="github-repo" content="mkempenaar/gene_expression_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" Discovering Differentialy Expressed Genes (DEGs) | Analysis of Gene Expression" />
  
  <meta name="twitter:description" content="Course Syllabus for BFV: Theme 07 course" />
  

<meta name="author" content="Marcel Kempenaar" />


<meta name="date" content="2022-03-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-3.html"/>
<link rel="next" href="a1-data_loading.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Analysis of Gene Expression</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#analysis-of-gene-expression-project"><i class="fa fa-check"></i>Analysis of Gene Expression Project</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chapter-1.html"><a href="chapter-1.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter-1.html"><a href="chapter-1.html#course-changes-due-to-covid-restrictions"><i class="fa fa-check"></i><b>1.1</b> Course changes due to COVID restrictions</a></li>
<li class="chapter" data-level="1.2" data-path="chapter-1.html"><a href="chapter-1.html#theme-7---analysis-of-gene-expression-project"><i class="fa fa-check"></i><b>1.2</b> Theme 7 - Analysis of Gene Expression Project</a></li>
<li class="chapter" data-level="1.3" data-path="chapter-1.html"><a href="chapter-1.html#project-deliverables"><i class="fa fa-check"></i><b>1.3</b> Project Deliverables</a></li>
<li class="chapter" data-level="1.4" data-path="chapter-1.html"><a href="chapter-1.html#project-schedule"><i class="fa fa-check"></i><b>1.4</b> Project Schedule</a></li>
<li class="chapter" data-level="1.5" data-path="chapter-1.html"><a href="chapter-1.html#grading"><i class="fa fa-check"></i><b>1.5</b> Grading</a></li>
<li class="chapter" data-level="1.6" data-path="chapter-1.html"><a href="chapter-1.html#project-proposal"><i class="fa fa-check"></i><b>1.6</b> Project Proposal</a></li>
<li class="chapter" data-level="1.7" data-path="chapter-1.html"><a href="chapter-1.html#lab-journal"><i class="fa fa-check"></i><b>1.7</b> <em>Lab Journal</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter-2.html"><a href="chapter-2.html"><i class="fa fa-check"></i><b>2</b> Discovering Data Sets</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-2.html"><a href="chapter-2.html#finding-public-data"><i class="fa fa-check"></i><b>2.1</b> Finding Public Data Sets of Interest</a></li>
<li class="chapter" data-level="2.2" data-path="chapter-2.html"><a href="chapter-2.html#ncbi-geo"><i class="fa fa-check"></i><b>2.2</b> The NCBI <em>Gene Expression Omnibus</em></a></li>
<li class="chapter" data-level="2.3" data-path="chapter-2.html"><a href="chapter-2.html#project-proposal_ch2"><i class="fa fa-check"></i><b>2.3</b> Creating a Project Proposal</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3.html"><a href="chapter-3.html"><i class="fa fa-check"></i><b>3</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-3.html"><a href="chapter-3.html#loading-data"><i class="fa fa-check"></i><b>3.1</b> Loading data into R</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-3.html"><a href="chapter-3.html#ch3_example_data"><i class="fa fa-check"></i><b>3.2</b> Example Data</a></li>
<li class="chapter" data-level="3.3" data-path="chapter-3.html"><a href="chapter-3.html#EDA_part1"><i class="fa fa-check"></i><b>3.3</b> Visualizing using <code>boxplot</code> and <code>density plot</code></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter-3.html"><a href="chapter-3.html#eda_statistics"><i class="fa fa-check"></i><b>3.3.1</b> Statistics</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter-3.html"><a href="chapter-3.html#eda_boxplots"><i class="fa fa-check"></i><b>3.3.2</b> Boxplots</a></li>
<li class="chapter" data-level="3.3.3" data-path="chapter-3.html"><a href="chapter-3.html#eda_density_plot"><i class="fa fa-check"></i><b>3.3.3</b> Density Plots</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter-3.html"><a href="chapter-3.html#EDA_part2"><i class="fa fa-check"></i><b>3.4</b> Visualizing using <code>heatmap</code> and <code>MDS</code></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-3.html"><a href="chapter-3.html#normalization"><i class="fa fa-check"></i><b>3.4.1</b> Normalization</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-3.html"><a href="chapter-3.html#eda_distance"><i class="fa fa-check"></i><b>3.4.2</b> Distance Calculation</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter-3.html"><a href="chapter-3.html#eda_heatmap"><i class="fa fa-check"></i><b>3.4.3</b> Sample Distances using a Heatmap</a></li>
<li class="chapter" data-level="3.4.4" data-path="chapter-3.html"><a href="chapter-3.html#eda_mds"><i class="fa fa-check"></i><b>3.4.4</b> Multi-Dimensional Scaling</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="chapter-3.html"><a href="chapter-3.html#cleaning-data"><i class="fa fa-check"></i><b>3.5</b> Cleaning Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-4.html"><a href="chapter-4.html"><i class="fa fa-check"></i><b>4</b> Discovering Differentialy Expressed Genes (DEGs)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-4.html"><a href="chapter-4.html#deg-preprocessing"><i class="fa fa-check"></i><b>4.1</b> Pre-processing</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-4.html"><a href="chapter-4.html#deg-fc"><i class="fa fa-check"></i><b>4.2</b> The <em>Fold Change</em> Value</a></li>
<li class="chapter" data-level="4.3" data-path="chapter-4.html"><a href="chapter-4.html#deg-bioconductor"><i class="fa fa-check"></i><b>4.3</b> Using Bioconductor Packages</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chapter-4.html"><a href="chapter-4.html#deg-design"><i class="fa fa-check"></i><b>4.3.1</b> The <code>Design</code> (matrix)</a></li>
<li class="chapter" data-level="4.3.2" data-path="chapter-4.html"><a href="chapter-4.html#deg-deseq2"><i class="fa fa-check"></i><b>4.3.2</b> <code>DESeq2</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="chapter-4.html"><a href="chapter-4.html#deg-edger"><i class="fa fa-check"></i><b>4.3.3</b> <code>edgeR</code></a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="a1-data_loading.html"><a href="a1-data_loading.html"><i class="fa fa-check"></i><b>A</b> Appendix A: Loading Expression Data in R</a>
<ul>
<li class="chapter" data-level="A.1" data-path="a1-data_loading.html"><a href="a1-data_loading.html#expl-data"><i class="fa fa-check"></i><b>A.1</b> Exploring the Available Project Data</a></li>
<li class="chapter" data-level="A.2" data-path="a1-data_loading.html"><a href="a1-data_loading.html#a1-batch_data_loading"><i class="fa fa-check"></i><b>A.2</b> Batch Loading Expression Data</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="a1-data_loading.html"><a href="a1-data_loading.html#decompressing"><i class="fa fa-check"></i><b>A.2.1</b> Decompressing</a></li>
<li class="chapter" data-level="A.2.2" data-path="a1-data_loading.html"><a href="a1-data_loading.html#determining-data-format"><i class="fa fa-check"></i><b>A.2.2</b> Determining Data Format</a></li>
<li class="chapter" data-level="A.2.3" data-path="a1-data_loading.html"><a href="a1-data_loading.html#loading-data-1"><i class="fa fa-check"></i><b>A.2.3</b> Loading Data</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysis of Gene Expression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-4" class="section level1" number="4">
<h1><span class="header-section-number"></span> Discovering Differentialy Expressed Genes (DEGs)</h1>
<p>The first and most important ‘real’ analysis step we will do is finding genes that show a difference in expression between sample groups; the <em>differentially expressed genes</em> (DEGs). The concept might sound rather simple; calculate the ratios for all genes between samples to determine the <strong>fold-change</strong> (FC) denoting the factor of change in expression between groups. Then, filter out only those genes that actually show a difference. While this does give a list of genes showing different behaviour across samples, we need to focus on genes that do not only show a difference, but are also <em>statistically significant</em>!</p>
<p>To determine whether or not a gene can be classified as a significant DEG we are going to use existing libraries, one of which your own article might refer to. Before we do that we’re going to a brief manual examination of the count data to make sure that you properly understand what we’re looking for: significance and the Fold-Change value.</p>
<div id="deg-preprocessing" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Pre-processing</h2>
<p>Given the results of the exploratory data analysis performed in <a href="chapter-3.html#chapter-3">chapter 3</a>, you might have concluded that there are one or more samples that show (very) deviating expression patterns compared to samples from the same group. As mentioned before, <em>if</em> you have more then enough (&gt; 3) samples in a group, you might opt to remove a sample to reduce the noise as the statistical tests are very sensitive to this. Since we are performing all analysis steps programatically it is also very easy to test for DEGs with and without the sample(s) in question and see if the removal results in lower p-values (= higher significance). If this is the case you can continue on without those sample(s), but</p>
<p>If your data <strong>only</strong> consists of the read counts we are going to apply another normalization technique. The previously used <code>vst</code> normalization is the advised method for the visualizations we performed, but for finding DEGs there are better methods. One of these generally accepted method of normalizing count data is to calculate the <em>fragments per million mapped fragments</em> (FPM) value and then transform this with log2. Opposed to FPKM and RPKM this does not include the gene-length in its calculation (which you most likely don’t have). If your dataset also includes FPKM or RPKM (pre-normalized), you are allowed to use this data too. Always clearly document if you did so!</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="chapter-4.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform FPM normalization using DESeq2 &#39;fpm&#39; and perform log2 transformation</span></span>
<span id="cb15-2"><a href="chapter-4.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The &#39;ddsMat&#39; object is the &#39;DESeqDataSet&#39; created in chapter 3; EDA.</span></span>
<span id="cb15-3"><a href="chapter-4.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: only for count data and observe the pseudocount of 1 (remove if data does not contain 0-values)</span></span>
<span id="cb15-4"><a href="chapter-4.html#cb15-4" aria-hidden="true" tabindex="-1"></a>counts.fpm <span class="ot">&lt;-</span> <span class="fu">log2</span>( <span class="fu">fpm</span>(ddsMat, <span class="at">robust =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="dv">1</span> )</span></code></pre></div>
<p>Another step we can do - and this might be guided by your article - is to filter out (partially) inactive genes. While this is only <em>required</em> when using the <code>edgeR</code> library (<code>DESeq2</code> includes its own low-count filtering methods), it is a good exercise to do manually and we will use it below when calculating the lFC values. Most datasets available contains a lot of 0-measurements (see for instance your density plot from the previous chapter); genes where no reads have mapped. In the R-studio <em>Environment</em> tab, click on your dataset (or perform the <code>View(data)</code> command and click on one of the sample columns to order the data ascending. You will now most likely (unless you have bacterial data for instance) see a lot of zero values in all columns. In an experiment with two groups, three replicates each, if three out of those six samples have 0-reads mapped, it is often adviced to remove the gene completely. But this can be very subjective to the experiment, it might be expected (thus important) when comparing different tissues or knockout experiments. Also, genes with a (very) low read count (&lt; 5) can give a very high (artificial) FC value (see the lefthand side of an MA-plot). Comparing two samples where one has a value of 2 and the other 11, this reads as an up-regulated gene by a factor of <em>5.5</em> while it might actually just be <em>noise</em>!</p>
<ul>
<li><strong>Assignment</strong>: Search through your article for any advice on how to filter out zero values or low count genes. If there is nothing stated on this subject, think of your own tactic (or search the literature/ online!). It is perfectly fine to discuss with your peers.
<ul>
<li><strong>describe</strong> what you will be doing for this aspect; if you do <em>not</em> filter your data, clearly explain why not (most likely because the article stated a proper reason)</li>
<li>Perform the filtering on your dataset. For this you will most likely need to use one of the <code>apply</code>, <code>rowSums</code>, <code>rowMeans</code> functions, combined with maybe the <code>which</code>, <code>all</code> and <code>any</code> functions. Data transformations/ normalizations are often available from functions too, such as the <code>cpm</code> function from the <code>edgeR</code> library.</li>
<li>Manually verify that the rows removed were correctly filtered.</li>
<li>Properly document how many genes have been filtered out!</li>
</ul></li>
</ul>
</div>
<div id="deg-fc" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> The <em>Fold Change</em> Value</h2>
<p>The FC is usually given as the calculated <code>log2</code> of the <em>case/control</em> ratio. For example, gene A has an average expression of 30 mapped reads in the control group and 88 reads in the experiment group, the <strong>ratio</strong> <em>case/control</em> is <code>2.93</code>. Ratio values &gt; 1 indicate increased expression in the experiment in relation to the control and values between 0 and 1 indicate lower expression. The log2 transformed value of the ratio is calculated with <code>log2(2.93)</code> and results in <code>1.55</code>. If the counts were reversed, the ratio would have been <code>30/88</code>, which is <code>0.34</code>. The previously calculated value of <code>2.93</code> means a 3-fold up regulation while the <code>0.34</code> value means 3-fold down regulation but you can see the range of numbers is very different. Comparing log2 values this would be <code>1.55</code> and <code>-1.55</code> which compares much better.</p>
<p>While it is very easy to calculate the FC for all genes at once, a simple FC value doesn’t mean much, yet! We still need to use the power that lie within the replicates we have for each sample group. Using these replicates, we want to determine if the observed FC is not just biological noise or a sequencing error.</p>
<ul>
<li><strong>Assignment</strong>: Create a <code>histogram</code> of your log2-FC values for <em>all</em> genes. Apply the following steps on your <em>FPM-normalized data</em> for at least one comparison (no need to do it for all possible combinations):
<ul>
<li>average the replicates for two groups separately and add this as new columns to your data set,</li>
<li>calculate the log Fold Change (lFC); simply <em>subtract</em> one group (averaged-column) by another, usually <code>experiment</code>-<code>control</code>
<ul>
<li>Note that since we already have log-transformed data, we do not calculate the ratio (<code>experiment</code>/<code>control</code>). Also, because of the Logarithm <em>quotient rule</em>, we do not divide both average colums as with the ratio calculation, but we subtract: <span class="math inline">\(log_b{(x/y)} = log_b{(x)} - log_b{(y)}\)</span></li>
</ul></li>
<li>plot the data using the <code>hist(logFC_column, breaks=60)</code> function (change the <code>breaks</code> argument if needed),</li>
<li>Add two vertical lines at <code>-1</code> and <code>1</code> (using <code>abline(v=...)</code>) to indicate some significance (2-fold change).
<ul>
<li>If your data shows very low fold-change values you might see no genes outside of this boundary. This does not mean that we will not find any significantly changed genes (DEGs).</li>
</ul></li>
</ul></li>
</ul>
<p>If a calculated FC shows a large change in expression between groups this means nothing if the variation <em>within</em> a group is very high. For this reason we use some form of statistical test that checks both the variation in each group <em>and</em> the difference between groups of samples. In the simplest form this usually comes down to using a <a href="https://en.wikipedia.org/wiki/Student%27s_t-test"><em>t</em>-test</a>:</p>
<blockquote>
<p>“It can be used to determine if two sets of data are significantly different from each other”</p>
</blockquote>
<p>Most often instead of manually performing t-tests or ANOVA analysis, the article mentions the use of one or more R libraries of other software packages for finding DEGs. This is exactly what we will also do in this chapter. The output of finding DEG’s always includes - but is not limited to - a list of <em>p-values</em>; one p-value <strong>per gene</strong>. This value indicates whether that gene is a <em>statistically-significant differentially expressed gene</em> (SDEG) and to find these genes of interest all we need to do is get all genes with a p-value below our threshold (i.e. <code>0.05</code>).</p>
</div>
<div id="deg-bioconductor" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Using Bioconductor Packages</h2>
<p>This section demonstrates the use of two packages to perform DEG-analysis on <strong>count</strong> data. There are many packages available on Bioconductor for RNA-Seq analysis, such as <code>DSS</code>, <code>EBSeq</code>, <code>NOISeq</code> and <code>BaySeq</code>, but here we will focus on <code>edgeR</code> and <code>DESeq2</code> for processing our count-based data. Chances are that one of these two packages are mentioned if the article described the use of R for the statistical analysis as they are the most widely accepted methods of processing gene expression data.</p>
<p>Both packages apply their own normalization methods (described in the sections below) therefore they only work on the <strong>raw</strong> count data. If your data consists of <strong>expected</strong> count data, you need to round these values down (using the <code>floor</code> function). You can choose one of these two packages to use, or use them both since it could increase statistical power and they are not very hard to use once you understand how to <strong>model</strong> the data as we’ll show next.</p>
<ul>
<li><strong>Assignment</strong>: Perform data-analysis using at least one of the two packages. If however your article mentioned a different R package for their analysis (for instance the <code>limma</code> package) it is allowed to use this one instead. Other non-R packages can only be done as an extra (each dataset can always be analyzed using both edgeR and DESeq2). Optionally, use more than one package so we can compare the results between the these packages.
<ul>
<li>Start by documenting the relevant information from the article, also if they used other software for this analysis.</li>
</ul></li>
</ul>

<div class="rmdtip">
The two listed packages come with a very complete and extensive manual. These manuals can be found as PDF on the BioConductor website, or opened from within R using the <code>vignette</code> function. To see all available manuals (note; these are very different from the function-help documentation) execute the function without arguments: <code>vignette()</code>. This lists the vignettes for edgeR and DESeq2 as:
* <code>vignette("DESeq2")</code> (this whole course is partly designed on this document!)
* <code>vignette("edgeR")</code>
</div>
<div id="deg-design" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> The <code>Design</code> (matrix)</h3>
<p>For all of these packages you need to properly specify <em>how</em> your samples are grouped. We have seen examples of this using an <code>R factor</code> object with the heatmap and MDS visualizations to tell which groups of samples we have and to which group each sample belongs. Reading the documentation for the below packages shows that this is an important part of performing DE-analysis. For example, the following code is shown in de <code>edgeR</code> documentation on page 8 where two sample groups are defined (numbered <code>1</code> and <code>2</code>), placed in a <code>factor</code> object and used as input in the <code>model.matrix</code> function.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chapter-4.html#cb16-1" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Case&quot;</span>))</span>
<span id="cb16-2"><a href="chapter-4.html#cb16-2" aria-hidden="true" tabindex="-1"></a>(design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>( <span class="sc">~</span> group))</span></code></pre></div>
<pre><code>##   (Intercept) groupCase
## 1           1         0
## 2           1         0
## 3           1         1
## 4           1         1
## attr(,&quot;assign&quot;)
## [1] 0 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$group
## [1] &quot;contr.treatment&quot;</code></pre>
<p>As mentioned before we <strong>need</strong> to think about the <em>question</em> we want to aks; which difference do we want to know? With two sample groups as used here the question is rather easy; ‘which genes show an effect between case/ control samples?’ With more then two sample groups however the question becomes more difficult. If we have an experiment comparing influence of three kinds of drugs (thus three groups) <em>combined</em> with effect over time, do we then want to focus on the influence of the <em>drugs</em> or the <em>time</em>? Both are valid questions but they define the way of how to create the <code>design matrix</code>.</p>
<p>Documentation on this subject is plenty, however it often contains overwhelming information. <a href="http://genomicsclass.github.io/book/pages/expressing_design_formula.html">This page</a> contains some valuable details (you can safely start reading at <strong>Choice of design</strong>), including the following text which is based on the same example used in the <code>edgeR</code> documentation:</p>
<blockquote>
<p>“For the examples we cover here, we use linear models to make comparisons between different groups. Hence, the design matrices that we ultimately work with will have at least two columns: an intercept column, which consists of a column of 1’s, and a second column, which specifies which samples are in a second group. In this case, two coefficients are fit in the linear model: the intercept, which represents the population average of the first group, and a second coefficient, which represents the difference between the population averages of the second group and the first group. The latter is typically the coefficient we are interested in when we are performing statistical tests: we want to know if their is a difference between the two groups.”</p>
</blockquote>
<p>If you have more then two sample groups and you want to change the <em>question</em> (i.e. test the influence of a different group), read the section about <strong>Releveling</strong> the <code>factor</code>.</p>
</div>
<div id="deg-deseq2" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> <code>DESeq2</code></h3>
<p>We have used the <code>DESeq2</code> library before and for DEG analysis we could re-use the <code>DESeqDataSet</code> object but it is adviced to create a new object with the proper design formula instead of the <code>~ 1</code> we used before.</p>
<p>There is no need to normalize the data using the previously used <code>vst</code> or <code>fpm</code> functions because the <code>DESeq2</code> library will normalize the count data for you as follows:</p>
<blockquote>
<p>“DESeq computes a scaling factor for a given sample by computing the median of the ratio, for each gene, of its read count over its geometric mean across all samples. It then uses the assumption that most genes are not DE and uses this median of ratios to obtain the scaling factor associated with this sample.”</p>
</blockquote>
<p>For our example data with four sample groups we re-use the annotation dataframe as created in the <a href="chapter-3.html#eda_heatmap">EDA: Heatmap</a> section (printed below). This allows us to do comparisons based on the celltype and ploidy of the samples. One minor note of importance is that the first level in each factor is taken as the <em>reference</em>, or for expression analysis, the <em>control</em> group. In our example (see the table below) the IPSC is the control-celltype and disomic the control-ploidy. In a simple case/ control study, the first level (check with the <code>levels()</code> function) should be the control group. Use the <code>relevel()</code> function if the levels need to be switched.</p>
<table style="width:53%;">
<colgroup>
<col width="25%" />
<col width="12%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Cell</th>
<th align="center">Ploidy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>di_IPSC_r1</strong></td>
<td align="center">IPSC</td>
<td align="center">disomic</td>
</tr>
<tr class="even">
<td align="center"><strong>di_IPSC_r2</strong></td>
<td align="center">IPSC</td>
<td align="center">disomic</td>
</tr>
<tr class="odd">
<td align="center"><strong>di_IPSC_r3</strong></td>
<td align="center">IPSC</td>
<td align="center">disomic</td>
</tr>
<tr class="even">
<td align="center"><strong>tri_IPSC_r1</strong></td>
<td align="center">IPSC</td>
<td align="center">trisomic</td>
</tr>
<tr class="odd">
<td align="center"><strong>tri_IPSC_r2</strong></td>
<td align="center">IPSC</td>
<td align="center">trisomic</td>
</tr>
<tr class="even">
<td align="center"><strong>tri_IPSC_r3</strong></td>
<td align="center">IPSC</td>
<td align="center">trisomic</td>
</tr>
<tr class="odd">
<td align="center"><strong>di_NEUR_r1</strong></td>
<td align="center">Neuron</td>
<td align="center">disomic</td>
</tr>
<tr class="even">
<td align="center"><strong>di_NEUR_r2</strong></td>
<td align="center">Neuron</td>
<td align="center">disomic</td>
</tr>
<tr class="odd">
<td align="center"><strong>di_NEUR_r3</strong></td>
<td align="center">Neuron</td>
<td align="center">disomic</td>
</tr>
<tr class="even">
<td align="center"><strong>tri_NEUR_r1</strong></td>
<td align="center">Neuron</td>
<td align="center">trisomic</td>
</tr>
<tr class="odd">
<td align="center"><strong>tri_NEUR_r2</strong></td>
<td align="center">Neuron</td>
<td align="center">trisomic</td>
</tr>
<tr class="even">
<td align="center"><strong>tri_NEUR_r3</strong></td>
<td align="center">Neuron</td>
<td align="center">trisomic</td>
</tr>
</tbody>
</table>
<p>Once you have a proper <code>DESeqDataSet</code> all you need to do is run the <code>DESeq</code> function on this object. Then, using the <code>results</code> function you can extract the DEGs as a <code>DESeqResults</code> object. Applying the <code>summary</code> function on these object(s) shows the number of up and down regulated DEGs as can be seen below that lists the impact of trisomy for the IPSC cell type (~800 DEGs) and comparing both the IPSC and Neuron disomic (control) cell types (as can be seen, a <em>huge</em> amount of genes are affected by differentiation from stem cell into cortical neurons):</p>
<table class="container">
<tr>
<th align="center">
IPSC - Trisomic vs Disomic
</th>
<th align="center">
Disomic Neuron vs Disomic IPSC
</th>
</tr>
<tr>
<td>
<pre>
out of 44504 with nonzero total read count
adjusted p-value < 0.05
LFC > 0 (up)       : 432, 0.97%
LFC < 0 (down)     : 417, 0.94%
outliers [1]       : 219, 0.49%
low counts [2]     : 17004, 38%
(mean count < 6)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results

</pre>
</td>
<td>
<pre>
out of 44504 with nonzero total read count
adjusted p-value < 0.05
LFC > 0 (up)       : 9594, 22%
LFC < 0 (down)     : 8224, 18%
outliers [1]       : 219, 0.49%
low counts [2]     : 11906, 27%
(mean count < 2)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results

</pre>
</td>
</tr>
</table>
<p>The output of the <code>results</code> function contains the following columns for each gene:</p>
<table style="width:89%;">
<colgroup>
<col width="23%" />
<col width="20%" />
<col width="44%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Column</th>
<th align="center">Type</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">baseMean</td>
<td align="center">intermediate</td>
<td align="center">mean of normalized counts for
all samples</td>
</tr>
<tr class="even">
<td align="center">log2FoldChange</td>
<td align="center">results</td>
<td align="center">log2 fold change (MLE): group
IPSC.trisomic vs IPSC.disomic</td>
</tr>
<tr class="odd">
<td align="center">lfcSE</td>
<td align="center">results</td>
<td align="center">standard error: group
IPSC.trisomic vs IPSC.disomic</td>
</tr>
<tr class="even">
<td align="center">stat</td>
<td align="center">results</td>
<td align="center">Wald statistic: group
IPSC.trisomic vs IPSC.disomic</td>
</tr>
<tr class="odd">
<td align="center">pvalue</td>
<td align="center">results</td>
<td align="center">Wald test p-value: group
IPSC.trisomic vs IPSC.disomic</td>
</tr>
<tr class="even">
<td align="center">padj</td>
<td align="center">results</td>
<td align="center">BH adjusted p-values</td>
</tr>
</tbody>
</table>
<p><em>How</em> you call the <code>results</code> function depends heavily on your experiment. As you can see from the output of the <code>summary</code> function, there are no details given about <em>which</em> comparison is shown (and also, by default a p-value of 0.1 is used instead of 0.05).</p>
<p>Depending on the <em>design</em> used to create the <code>DESeqDataSet</code> with, one or more comparisons can be made (applying the <code>DESeq</code> function calculates all and you filter with the <code>results</code> function). Read the help for the <code>results</code> function carefully; especially regarding the <code>contrast</code> argument where you define the comparison to retrieve. The following code can be used for our example experiment to get the DEGs comparing the celltypes using an adjusted p-value of 0.05:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chapter-4.html#cb18-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">&quot;Cell&quot;</span>, <span class="st">&quot;IPSC&quot;</span>, <span class="st">&quot;Neuron&quot;</span>),</span>
<span id="cb18-2"><a href="chapter-4.html#cb18-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p>The <code>DESeq2</code> library contains a number of plotting functions that can be applied to a <code>DESeqResults</code> object (output of the <code>results</code> function), the most notable is the <code>plotMA</code> function. Note that the first MA-plot shown below has a very high range for the log fold changes (-10, 10) where the maximum value is 22.4 (shown as a triangle stating it is outside of the plotting range). A <strong>log</strong> fold change of 22 means &gt;5 <em>million</em> increased expression which seems artificially high. DESeq2 includes a function to perform downstream processing of the estimated log fold change values called <code>lfcShrink</code> which is adviced to always run afterwards. The reason for executing this function is described in the vignette with:</p>
<blockquote>
<p>“It is more useful visualize the MA-plot for the shrunken log2 fold changes, which remove the noise associated with log2 fold changes from low count genes without requiring arbitrary filtering thresholds.”</p>
</blockquote>
<div class="figure"><span style="display:block;" id="fig:DESeq2MAPlot"></span>
<img src="chapters/images/DESeq2MAplot.png" alt="MA-plots with the standard DESeq2 output (left) and after shrinking with 'lfcShrink' (right)"  />
<p class="caption">
Figure 4.1: MA-plots with the standard DESeq2 output (left) and after shrinking with ‘lfcShrink’ (right)
</p>
</div>
<p><strong>Links</strong></p>
<ul>
<li><a href="https://www.bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html">Analyzing RNA-seq data with DESeq2</a> A <em>very</em> comprehensive guide to analyzing RNA-Seq data using DESeq2 (part of this document has been used in this material too!). It is adviced to read the first few sections of this guide and take a good look at the index of the document because there are many interesting sections that might be of help later.</li>
<li><a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-014-0550-8">Publication</a>, an accompanying article showing differences in performance compared to other methods and packages.</li>
</ul>
</div>
<div id="deg-edger" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> <code>edgeR</code></h3>
<p>One of the most mature libraries for RNA-Seq data analysis is the <code>edgeR</code> library available on <a href="http://bioconductor.org/packages/release/bioc/html/edgeR.html">Bioconductor</a>. There is a very complete (sometimes a bit complex) manual available of which you need to read <a href="https://bioconductor.org/packages/release/bioc/vignettes/edgeR/inst/doc/edgeRUsersGuide.pdf">Chapter 2</a> with a focus on 2.1 to 2.7, 2.9 and - if you have a more complex design - 2.10. Section 1.4 (Quickstart) shows a code example on the steps needed to do DEG analysis using count data using the two <code>glm</code> methods (<em>quasi-likelihood F-tests</em> and <em>likelihood ratio tests</em>). All the steps shown there are identical for the non-<code>glm</code> method up to calculating the <code>fit</code> object which can be replaced by performing the <code>exactTest</code> function as shown in section 2.9.2.</p>
<p>The <code>edgeR</code> library will normalize the count data for you as follows:</p>
<blockquote>
<p>“The trimmed means of M values (TMM) from Robinson and Oshlack, which is implemented in edgeR, computes a scaling factor between two experiments by using the weighted average of the subset of genes after excluding genes that exhibit high average read counts and genes that have large differences in expression.”</p>
</blockquote>
<p>Running edgeR requires the raw count data together with the grouping-factor packaged in a <code>DGEList</code> object (with the <code>DGEList()</code> function). Furthermore, a proper <code>model.matrix</code> object (see the section on <a href="chapter-4.html#deg-design">design</a>) is needed as input for the <code>estimateDisp</code> function. The exact steps to take (there are more variations than with DESeq2) must be searched in the documentation linked above.</p>
<p>Once the analysis is done you can retrieve the actual results with the <code>topTags</code> function:</p>
<table>
<colgroup>
<col width="19%" />
<col width="14%" />
<col width="11%" />
<col width="11%" />
<col width="10%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">genes</th>
<th align="center">logFC</th>
<th align="center">logCPM</th>
<th align="center">F</th>
<th align="center">PValue</th>
<th align="center">FDR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>PCDHA10</strong></td>
<td align="center">PCDHA10</td>
<td align="center">-3.602</td>
<td align="center">5.676</td>
<td align="center">499.9</td>
<td align="center">8.164e-11</td>
<td align="center">1.354e-06</td>
</tr>
<tr class="even">
<td align="center"><strong>CHGA</strong></td>
<td align="center">CHGA</td>
<td align="center">2.923</td>
<td align="center">5.976</td>
<td align="center">185.4</td>
<td align="center">1.972e-08</td>
<td align="center">0.0001635</td>
</tr>
<tr class="odd">
<td align="center"><strong>ARRB1</strong></td>
<td align="center">ARRB1</td>
<td align="center">-3.914</td>
<td align="center">5.015</td>
<td align="center">158.3</td>
<td align="center">4.627e-08</td>
<td align="center">0.0002019</td>
</tr>
<tr class="even">
<td align="center"><strong>TSSC2</strong></td>
<td align="center">TSSC2</td>
<td align="center">3.175</td>
<td align="center">3.301</td>
<td align="center">156.8</td>
<td align="center">4.869e-08</td>
<td align="center">0.0002019</td>
</tr>
<tr class="odd">
<td align="center"><strong>LRFN5</strong></td>
<td align="center">LRFN5</td>
<td align="center">-4.638</td>
<td align="center">4.118</td>
<td align="center">144.9</td>
<td align="center">7.435e-08</td>
<td align="center">0.0002237</td>
</tr>
<tr class="even">
<td align="center"><strong>C11orf54</strong></td>
<td align="center">C11orf54</td>
<td align="center">-1.953</td>
<td align="center">4.915</td>
<td align="center">139.9</td>
<td align="center">8.985e-08</td>
<td align="center">0.0002237</td>
</tr>
<tr class="odd">
<td align="center"><strong>MAP2</strong></td>
<td align="center">MAP2</td>
<td align="center">2.647</td>
<td align="center">9.468</td>
<td align="center">138.6</td>
<td align="center">9.439e-08</td>
<td align="center">0.0002237</td>
</tr>
<tr class="even">
<td align="center"><strong>WNT3</strong></td>
<td align="center">WNT3</td>
<td align="center">-3.488</td>
<td align="center">3.273</td>
<td align="center">106.7</td>
<td align="center">3.742e-07</td>
<td align="center">0.0007758</td>
</tr>
<tr class="odd">
<td align="center"><strong>TFAP2C</strong></td>
<td align="center">TFAP2C</td>
<td align="center">-2.984</td>
<td align="center">4.591</td>
<td align="center">96.48</td>
<td align="center">6.321e-07</td>
<td align="center">0.001165</td>
</tr>
<tr class="even">
<td align="center"><strong>ASAP2</strong></td>
<td align="center">ASAP2</td>
<td align="center">1.352</td>
<td align="center">5.876</td>
<td align="center">94.25</td>
<td align="center">7.133e-07</td>
<td align="center">0.001183</td>
</tr>
</tbody>
</table>
<p>Most significant genes given by edgeR</p>
<p>The package also contains a few plotting methods that you can use at intermediate steps during the analysis. For instance, after calculating the normalization factors (<code>calcNormFactors</code>), you can perform multi-dimensional scaling with the <code>plotMDS</code> function which is similar to what we’ve done manually in chapter three:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapter-4.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotMDS</span>(y)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:edgeRPlotMDS"></span>
<img src="gene_expression_files/figure-html/edgeRPlotMDS-1.png" alt="edgeR MDS plot based on the calculated log2 fold changes" width="672" />
<p class="caption">
Figure 4.2: edgeR MDS plot based on the calculated log2 fold changes
</p>
</div>
<p>Or the <em>dispersion</em> after running the <code>estimateDisp</code> function with the <code>plotBCV</code> function:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="chapter-4.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotBCV</span>(y)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:edgeRPlotBCV"></span>
<img src="gene_expression_files/figure-html/edgeRPlotBCV-1.png" alt="edgeR plot of several dispersion methods" width="672" />
<p class="caption">
Figure 4.3: edgeR plot of several dispersion methods
</p>
</div>
<p>Or the log-fold changes for all genes, once we have the output of the <code>exactTest</code> function (output <code>et</code> is an <code>DGEExact</code> object) with the <code>plotSmear</code> function. The <code>abline</code> shows a log-FC threshold:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="chapter-4.html#cb21-1" aria-hidden="true" tabindex="-1"></a>deGenes <span class="ot">&lt;-</span> <span class="fu">decideTestsDGE</span>(qlf, <span class="at">p=</span><span class="fl">0.05</span>)</span>
<span id="cb21-2"><a href="chapter-4.html#cb21-2" aria-hidden="true" tabindex="-1"></a>deGenes <span class="ot">&lt;-</span> <span class="fu">rownames</span>(qlf)[<span class="fu">as.logical</span>(deGenes)]</span>
<span id="cb21-3"><a href="chapter-4.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotSmear</span>(qlf, <span class="at">de.tags=</span>deGenes)</span>
<span id="cb21-4"><a href="chapter-4.html#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:edgerResults"></span>
<img src="gene_expression_files/figure-html/edgerResults-1.png" alt="edgeR results; genes marked in red are DEGs" width="672" />
<p class="caption">
Figure 4.4: edgeR results; genes marked in red are DEGs
</p>
</div>
<p><strong>Links</strong></p>
<ul>
<li><a href="http://bioinformatics-core-shared-training.github.io/cruk-bioinf-sschool/Day3/rnaSeq_DE.pdf">Differential Expression Analysis using edgeR</a> tutorial</li>
<li><a href="https://gist.github.com/jdblischak/11384914">Another tutorial</a> hosted on GitHub</li>
</ul>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="chapter-3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a1-data_loading.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
