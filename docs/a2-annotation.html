<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>B Annotating an RNA-Seq Experiment | Capstone Project - Gene Expression Analysis</title>
<meta name="author" content="Marcel Kempenaar">
<meta name="description" content="This chapter describes annotate the data, meaning assigning names and functions to our Differentially Expressed Genes. This step can either be very easy or a bit more challenging depending on the...">
<meta name="generator" content="bookdown 0.36 with bs4_book()">
<meta property="og:title" content="B Annotating an RNA-Seq Experiment | Capstone Project - Gene Expression Analysis">
<meta property="og:type" content="book">
<meta property="og:description" content="This chapter describes annotate the data, meaning assigning names and functions to our Differentially Expressed Genes. This step can either be very easy or a bit more challenging depending on the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="B Annotating an RNA-Seq Experiment | Capstone Project - Gene Expression Analysis">
<meta name="twitter:description" content="This chapter describes annotate the data, meaning assigning names and functions to our Differentially Expressed Genes. This step can either be very easy or a bit more challenging depending on the...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Capstone Project - Gene Expression Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="datasets.html"><span class="header-section-number">2</span> Discovering Data Sets</a></li>
<li><a class="" href="EDA.html"><span class="header-section-number">3</span> Exploratory Data Analysis</a></li>
<li><a class="" href="chapter-4.html"><span class="header-section-number">4</span> Discovering Differentialy Expressed Genes (DEGs)</a></li>
<li><a class="" href="chapter-5.html"><span class="header-section-number">5</span> Data Analysis and Visualization</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="a1-data_loading.html"><span class="header-section-number">A</span> Loading Expression Data in R</a></li>
<li><a class="active" href="a2-annotation.html"><span class="header-section-number">B</span> Annotating an RNA-Seq Experiment</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="a2-annotation" class="section level1" number="7">
<h1>
<span class="header-section-number">B</span> Annotating an RNA-Seq Experiment<a class="anchor" aria-label="anchor" href="#a2-annotation"><i class="fas fa-link"></i></a>
</h1>
<p>This chapter describes <em>annotate</em> the data, meaning assigning names and functions to our Differentially Expressed Genes. This step can either be very easy or a bit more challenging depending on the data source of your project. The first example is relevant if your data set originated from the NCBI <strong>GEO</strong>, which ‘should’ always be annotated by default. If you have found your data set elsewhere (and do not have a GEO identifier for your project), skip to the <a href="a2-annotation.html#manually-annotate">Manually annotate your data</a> section below.</p>
<p>The goal of this chapter is to - at least - find a Gene Symbol or common ID (NCBI/ Ensembl) for each gene. Using this information it will be much easier to find relevant information from other online sources to say something about the functionality and impact of your DEGs.</p>
<p>Even though you might be lucky and either already have your data or a simple GEO query results in everything you want/ need, you are tasked to <em>also</em> perform the manual annotation phase even if you will not use any of the found annotation data. Having written the code to access these sources is a good excercise in using complex Bioconductor packages. Also, you can always use this to find more information should you require this later on.</p>
<div id="download-geo" class="section level2" number="7.1">
<h2>
<span class="header-section-number">B.1</span> Downloading annotation data from GEO<a class="anchor" aria-label="anchor" href="#download-geo"><i class="fas fa-link"></i></a>
</h2>
<p>Given the <code>GSE****</code> id of your experiment you can download any available (annotation)data from GEO using the <code>GEOquery</code> library. For the example experiment used previously, the following code downloads two files; a <code>series_matrix.txt.gz</code> file that is also available for download from the NCBI GEO website. Note the <code>destdir</code> argument for storing it in a known location instead of the <code>/tmp</code> folder for later use.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/seandavi/GEOquery">GEOquery</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="http://seandavi.github.io/GEOquery/reference/getGEO.html">getGEO</a></span><span class="op">(</span>GEO <span class="op">=</span> <span class="st">'GSE101942'</span>, destdir <span class="op">=</span> <span class="st">"./data/"</span><span class="op">)</span></span></code></pre></div>
<p>Once downloaded, you can load the data using:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/seandavi/GEOquery">GEOquery</a></span><span class="op">)</span></span>
<span><span class="va">gse</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://seandavi.github.io/GEOquery/reference/getGEO.html">getGEO</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">'./data/GSE101942_series_matrix.txt.gz'</span><span class="op">)</span></span></code></pre></div>
<p>The <code>gse</code> object <em>may</em> contain useful information about both samples and genes. Unfortunately for this example data set there is only information available regarding the samples which we can access in the <code>phenoData</code> <strong>slot</strong>. Slots in R objects are a method of storing multiple data objects into a single R object, in this case this object is called an <code>ExpressionSet</code> (see <code><a href="https://rdrr.io/pkg/Biobase/man/class.ExpressionSet.html">?ExpressionSet</a></code> for a description of its contents and structure). For storing information about an experiment this is very handy; you can store a data frame with the actual expression data, a list containing laboratory information, a chunk of text with an abstract, etc. all in a single object.</p>
<p>The most common data sets found in an <code>ExpressionSet</code> object:
* <code>@assayData</code>: the actual expression data. Most common for microarray experiments and (very) rare for RNA-seq experiments
* <code>@phenoData</code>: sample information, should be present for each GEO data set
* <code>@featureData</code>: a data frame holding feature (=gene) information, slightly rare for RNA-seq data sets
* <code>@experimentData</code>: information about the lab which performed the experiment</p>
<p>You already know how to access a column in a data frame using the <code>$</code> notation, and accessing a complete data frame in the <code>gse</code> object is done using the <code>@</code> symbol:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access a data frame containing phenotype information</span></span>
<span><span class="va">gse</span><span class="op">@</span><span class="va">phenoData</span><span class="op">@</span><span class="va">data</span></span></code></pre></div>
<p>Here you see that each sample is described using its sample identifier (<code>GSM****</code>), information about the the sample group (<code>title</code> column) and a number of characteristics. The actual information included depends on your data set.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="22%">
<col width="11%">
<col width="23%">
<col width="42%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">title</th>
<th align="center">source_name_ch1</th>
<th align="center">characteristics_ch1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>GSM2719212</strong></td>
<td align="center">C2A</td>
<td align="center">trisomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719213</strong></td>
<td align="center">C2B</td>
<td align="center">trisomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="odd">
<td align="center"><strong>GSM2719214</strong></td>
<td align="center">C2C</td>
<td align="center">trisomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719215</strong></td>
<td align="center">C244-A</td>
<td align="center">disomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="odd">
<td align="center"><strong>GSM2719216</strong></td>
<td align="center">C244-B</td>
<td align="center">disomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719217</strong></td>
<td align="center">C243</td>
<td align="center">disomic_IPSC</td>
<td align="center">cell type: human induced
pluripotent stem cells (iPSCs)</td>
</tr>
</tbody>
</table></div>
<p>Contents of the <code>gse@phenoData@data</code> information (selection) (continued below)</p>
<div class="inline-table"><table style="width:57%;" class="table table-sm">
<colgroup>
<col width="23%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">characteristics_ch1.1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>GSM2719212</strong></td>
<td align="center">ploidy: trisomic</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719213</strong></td>
<td align="center">ploidy: trisomic</td>
</tr>
<tr class="odd">
<td align="center"><strong>GSM2719214</strong></td>
<td align="center">ploidy: trisomic</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719215</strong></td>
<td align="center">ploidy: disomic</td>
</tr>
<tr class="odd">
<td align="center"><strong>GSM2719216</strong></td>
<td align="center">ploidy: disomic</td>
</tr>
<tr class="even">
<td align="center"><strong>GSM2719217</strong></td>
<td align="center">ploidy: disomic</td>
</tr>
</tbody>
</table></div>
<p>If your data set has properly annotated gene information, this should be accessible in the <code>@featureData</code> slot. For instance, the data set <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE20489"><code>GSE20489</code></a> does have this annotation available. Once loaded, we see that the following annotation columns are present for <em>each gene</em> in the <code>featureData</code> slot (following is a small subset, in total there can be well over 20 columns of information per gene). Also, the <em>metadata</em> listing shows for how many features (=genes, 54675) and samples (54) the expression data is present (in the <code>@assayData</code> slot):</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This gets a list with a single 'ExpressionSet' object</span></span>
<span><span class="va">GSE20489</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://seandavi.github.io/GEOquery/reference/getGEO.html">getGEO</a></span><span class="op">(</span>GEO <span class="op">=</span> <span class="st">"GSE20489"</span>, destdir <span class="op">=</span> <span class="st">'./data'</span><span class="op">)</span></span>
<span><span class="co"># Print some metadata of the featureData slot</span></span>
<span><span class="va">GSE20489</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code>## ExpressionSet (storageMode: lockedEnvironment)
## assayData: 54675 features, 54 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: GSM514737 GSM514738 ... GSM514790 (54 total)
##   varLabels: title geo_accession ... tissue:ch1 (39 total)
##   varMetadata: labelDescription
## featureData
##   featureNames: 1007_s_at 1053_at ... AFFX-TrpnX-M_at (54675 total)
##   fvarLabels: ID GB_ACC ... Gene Ontology Molecular Function (16 total)
##   fvarMetadata: Column Description labelDescription
## experimentData: use 'experimentData(object)'
##   pubMedIds: 23883607 
## Annotation: GPL570</code></pre>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="15%">
<col width="35%">
<col width="23%">
<col width="26%">
</colgroup>
<thead><tr class="header">
<th align="center">ID</th>
<th align="center">Gene Title</th>
<th align="center">Gene Symbol</th>
<th align="center">ENTREZ_GENE_ID</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1007_s_at</td>
<td align="center">discoidin domain receptor
tyrosine kinase …</td>
<td align="center">DDR1 /// MIR4640</td>
<td align="center">780 /// 100616237</td>
</tr>
<tr class="even">
<td align="center">1053_at</td>
<td align="center">replication factor C
(activator 1) 2, 40kDa</td>
<td align="center">RFC2</td>
<td align="center">5982</td>
</tr>
<tr class="odd">
<td align="center">117_at</td>
<td align="center">heat shock 70kDa protein
6 (HSP70B’)</td>
<td align="center">HSPA6</td>
<td align="center">3310</td>
</tr>
<tr class="even">
<td align="center">121_at</td>
<td align="center">paired box 8</td>
<td align="center">PAX8</td>
<td align="center">7849</td>
</tr>
<tr class="odd">
<td align="center">1255_g_at</td>
<td align="center">guanylate cyclase
activator 1A (retina)</td>
<td align="center">GUCA1A</td>
<td align="center">2978</td>
</tr>
<tr class="even">
<td align="center">1294_at</td>
<td align="center">microRNA 5193 ///
ubiquitin-like modifier
…</td>
<td align="center">MIR5193 /// UBA7</td>
<td align="center">7318 /// 100847079</td>
</tr>
</tbody>
</table></div>
<p>Gene information stored in an <code>ExpressionSet</code> object for experiment GSE20489 (continued below)</p>
<div class="inline-table"><table style="width:39%;" class="table table-sm">
<colgroup><col width="38%"></colgroup>
<thead><tr class="header">
<th align="center">Gene Ontology Biological
Process</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0001558 // regulation of
cell growth // in…</td>
</tr>
<tr class="even">
<td align="center">0000278 // mitotic cell
cycle // traceable…</td>
</tr>
<tr class="odd">
<td align="center">0000902 // cell
morphogenesis // inferred
…</td>
</tr>
<tr class="even">
<td align="center">0001655 // urogenital
system development /…</td>
</tr>
<tr class="odd">
<td align="center">0007165 // signal
transduction //
non-trac…</td>
</tr>
<tr class="even">
<td align="center">0006464 // cellular
protein modification p…</td>
</tr>
</tbody>
</table></div>
</div>
<div id="manually-annotate" class="section level2" number="7.2">
<h2>
<span class="header-section-number">B.2</span> Manual Data Annotation<a class="anchor" aria-label="anchor" href="#manually-annotate"><i class="fas fa-link"></i></a>
</h2>
<p>Luckily for us, R offers a number of libraries to automatically retrieve information for large sets of genes, unless you have chosen an organism for which not much data is available. This section demonstrates the use of two such libraries, starting with <code>AnnotationDbi</code> followed by <code>biomaRt</code>.</p>
<p>The <code>AnnotationDbi</code> library downloads a local copy of an organism-specific database with gene information where <code>biomaRt</code> uses online databases to retrieve data given a <code>query</code>. <code>biomaRt</code> offers far more data (over 1000 data fields per organism) but is more complex to use.</p>
<p>Since <code>biomaRt</code> is also relying on online databases it might be a good strategy to annotate only the genes of interest (the DEGs) instead of querying for &gt;20.000 genes while we might only retain 20 after statistical analysis. If you are planning to use <code>biomaRt</code>, skip to the <a href="#discover-degs">Discovering Differentialy Expressed Genes (DEGs)</a> chapter first and then return to the <span id="using-biomart">Using R Bioconductors <code>biomaRt</code></span> section to annotate the data.</p>
<div id="annotationDBI" class="section level3" number="7.2.1">
<h3>
<span class="header-section-number">B.2.1</span> Using <code>AnnotationDBI</code><a class="anchor" aria-label="anchor" href="#annotationDBI"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>AnnotationDbi</code> offers data sets for many organisms in the form of installable libraries and depending on your experiment you need to find the proper library. The example experiment contains samples of the house mouse (Mus musculus) and therefore we select its data set.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the AnnotationDbi interface library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/AnnotationDbi">AnnotationDbi</a></span><span class="op">)</span></span>
<span><span class="co"># Load the Bioconductor installation library (contains 'biocLite()')</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">BiocInstaller</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install and load the organism specific gene database</span></span>
<span><span class="co"># 'org' for Organism</span></span>
<span><span class="co"># 'Hs' for Homo sapiens</span></span>
<span><span class="co"># 'eg' for Entrez Gene IDs</span></span>
<span><span class="co"># (try to load (using the library function) first before installing, it might already be present)</span></span>
<span><span class="fu">biocLite</span><span class="op">(</span><span class="st">'org.Hs.eg.db'</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span></span></code></pre></div>
<p>The following information types are available in this database (use the <code>columns</code> function to inspect).</p>
<div class="inline-table"><table style="width:88%;" class="table table-sm">
<colgroup>
<col width="20%">
<col width="19%">
<col width="19%">
<col width="13%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center">Columns</th>
<th align="center">Columns</th>
<th align="center">Columns</th>
<th align="center">Columns</th>
<th align="center">Columns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">ACCNUM</td>
<td align="center">ENZYME</td>
<td align="center">GOALL</td>
<td align="center">PATH</td>
<td align="center">UCSCKG</td>
</tr>
<tr class="even">
<td align="center">ALIAS</td>
<td align="center">EVIDENCE</td>
<td align="center">IPI</td>
<td align="center">PFAM</td>
<td align="center">UNIPROT</td>
</tr>
<tr class="odd">
<td align="center">ENSEMBL</td>
<td align="center">EVIDENCEALL</td>
<td align="center">MAP</td>
<td align="center">PMID</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">ENSEMBLPROT</td>
<td align="center">GENENAME</td>
<td align="center">OMIM</td>
<td align="center">PROSITE</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">ENSEMBLTRANS</td>
<td align="center">GENETYPE</td>
<td align="center">ONTOLOGY</td>
<td align="center">REFSEQ</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">ENTREZID</td>
<td align="center">GO</td>
<td align="center">ONTOLOGYALL</td>
<td align="center">SYMBOL</td>
<td align="center"></td>
</tr>
</tbody>
</table></div>
<p>Available fields in the database</p>
<p>The table below shows the data available for all information types given a randomly chosen <a href="http://www.ncbi.nlm.nih.gov/gene/1080"><em>EntrezID</em> of ‘1080’</a>. Note that the table has been split to show the 24 data types with their values.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">.Hs.data.table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html">cbind</a></span><span class="op">(</span><span class="va">.Hs.data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,<span class="op">]</span>, <span class="va">.Hs.data</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">24</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">.Hs.data.table</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Data Type'</span>, <span class="st">'Example Value'</span>,</span>
<span>                              <span class="st">'Data Type'</span>, <span class="st">'Example Value'</span><span class="op">)</span></span>
<span><span class="fu">pander</span><span class="op">(</span><span class="va">.Hs.data.table</span>, caption<span class="op">=</span><span class="st">"Example values for each field in 'org.Hs.eg.db'"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="19%">
<col width="40%">
<col width="18%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th align="center">Data Type</th>
<th align="center">Example Value</th>
<th align="center">Data Type</th>
<th align="center">Example Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">ACCNUM</td>
<td align="center">AAA35680</td>
<td align="center">GOALL</td>
<td align="center"><a href="GO:0000003" class="uri">GO:0000003</a></td>
</tr>
<tr class="even">
<td align="center">ALIAS</td>
<td align="center">ABC35</td>
<td align="center">IPI</td>
<td align="center">IPI00815998</td>
</tr>
<tr class="odd">
<td align="center">ENSEMBL</td>
<td align="center">ENSG00000001626</td>
<td align="center">MAP</td>
<td align="center">7q31.2</td>
</tr>
<tr class="even">
<td align="center">ENSEMBLPROT</td>
<td align="center">NA</td>
<td align="center">OMIM</td>
<td align="center">167800</td>
</tr>
<tr class="odd">
<td align="center">ENSEMBLTRANS</td>
<td align="center">NA</td>
<td align="center">ONTOLOGY</td>
<td align="center">MF</td>
</tr>
<tr class="even">
<td align="center">ENTREZID</td>
<td align="center">NA</td>
<td align="center">ONTOLOGYALL</td>
<td align="center">BP</td>
</tr>
<tr class="odd">
<td align="center">ENZYME</td>
<td align="center">3.6.3.49</td>
<td align="center">PATH</td>
<td align="center">02010</td>
</tr>
<tr class="even">
<td align="center">EVIDENCE</td>
<td align="center">IDA</td>
<td align="center">PFAM</td>
<td align="center">PF14396</td>
</tr>
<tr class="odd">
<td align="center">EVIDENCEALL</td>
<td align="center">ISS</td>
<td align="center">PMID</td>
<td align="center">1284466</td>
</tr>
<tr class="even">
<td align="center">GENENAME</td>
<td align="center">CF transmembrane conductance
regulator</td>
<td align="center">PROSITE</td>
<td align="center">PS00211</td>
</tr>
<tr class="odd">
<td align="center">GENETYPE</td>
<td align="center">protein-coding</td>
<td align="center">REFSEQ</td>
<td align="center">NM_000492</td>
</tr>
<tr class="even">
<td align="center">GO</td>
<td align="center"><a href="GO:0005254" class="uri">GO:0005254</a></td>
<td align="center">SYMBOL</td>
<td align="center">CFTR</td>
</tr>
</tbody>
</table></div>
<p>Example values for each field in ‘org.Hs.eg.db’</p>
<p>Retrieving data from the locally stored annotation database can be done using the <code>mapIds</code> function which takes a number of arguments:</p>
<ul>
<li>
<strong><code>x</code></strong>: the local database to query</li>
<li>
<strong><code>keys</code></strong>: the IDs from your <em>own</em> data set, most often you have <code>ENSEMBL</code> IDs or gene <code>SYMBOLS</code>. In the example data the <code>rownames</code> of the data set contain the gene <code>SYMBOLS</code> (see Table 1 on page 2)</li>
<li>
<strong><code>column</code></strong>: the data column to <em>retrieve</em> from the database</li>
<li>
<strong><code>keytype</code></strong>: the type of data that you <em>provide</em>. In the example data this is a gene <code>SYMBOL</code>
</li>
<li>
<strong><code>multiVals</code></strong>: a number of columns contain more then one entry for a single gene, in that case we only want to store the first one.</li>
</ul>
<p>The output of the <code>mapIds</code> function is a single character vector that we can add to our data frame containing the DEGs (in this case the DEGs for the IPSC trisomic vs disomic comparison containing 828 genes stored in the <code>ipsc.tri.vs.di</code> data frame).</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve the ENSEMBL gene ID, e.g. 'ENSG00000001626'</span></span>
<span><span class="va">ipsc.tri.vs.di</span><span class="op">$</span><span class="va">Ensembl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">mapIds</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,</span>
<span>                           keys<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">ipsc.tri.vs.di</span><span class="op">)</span>,</span>
<span>                           column<span class="op">=</span><span class="st">"ENSEMBL"</span>,</span>
<span>                           keytype<span class="op">=</span><span class="st">"SYMBOL"</span>,</span>
<span>                           multiVals<span class="op">=</span><span class="st">"first"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Retrieve the ENTREZ gene ID, e.g. '12323'</span></span>
<span><span class="va">ipsc.tri.vs.di</span><span class="op">$</span><span class="va">EntrezID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">mapIds</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,</span>
<span>                            keys<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">ipsc.tri.vs.di</span><span class="op">)</span>,</span>
<span>                            column<span class="op">=</span><span class="st">"ENTREZID"</span>,</span>
<span>                            keytype<span class="op">=</span><span class="st">"SYMBOL"</span>,</span>
<span>                            multiVals<span class="op">=</span><span class="st">"first"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Retrieve the KEGG enzyme code, e.g. 2.7.11.17</span></span>
<span><span class="va">ipsc.tri.vs.di</span><span class="op">$</span><span class="va">Enzyme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">mapIds</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,</span>
<span>                           keys<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">ipsc.tri.vs.di</span><span class="op">)</span>,</span>
<span>                           column<span class="op">=</span><span class="st">"ENZYME"</span>,</span>
<span>                           keytype<span class="op">=</span><span class="st">"SYMBOL"</span>,</span>
<span>                           multiVals<span class="op">=</span><span class="st">"first"</span><span class="op">)</span></span></code></pre></div>
<p>Unfortunately, not all organisms offer access to such information nor is the information always complete. For instance, the following table shows the number of available records for the Ensembl, Entrez en KEGG IDs downloaded:</p>
<div class="inline-table"><table style="width:61%;" class="table table-sm">
<colgroup>
<col width="22%">
<col width="13%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">ENSEMBL</th>
<th align="center">ENTREZ</th>
<th align="center">ENZYME</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Available</strong></td>
<td align="center">628</td>
<td align="center">644</td>
<td align="center">62</td>
</tr>
<tr class="even">
<td align="center"><strong>Missing</strong></td>
<td align="center">221</td>
<td align="center">205</td>
<td align="center">787</td>
</tr>
</tbody>
</table></div>
<p>Statistics for annotation columns using AnnotationDbi</p>
<p>For other data sets you might have more luck, otherwise continue with the <code>biomaRt</code> method explained below.</p>
</div>
<div id="using-biomart" class="section level3" number="7.2.2">
<h3>
<span class="header-section-number">B.2.2</span> Using <code>biomaRt</code><a class="anchor" aria-label="anchor" href="#using-biomart"><i class="fas fa-link"></i></a>
</h3>
<p>A short explanation about biomart (source: <a href="https://en.wikipedia.org/wiki/Ensembl_Genomes#BioMart">Wikipedia</a>):</p>
<blockquote>
<p>“The purpose of the BioMarts in Ensembl Genomes is to allow the user to mine and download tables containing all the genes for a single species, genes in a specific region of a chromosome or genes on one region of a chromosome associated with an InterPro domain. The BioMarts also include filters to refine the data to be extracted and the attributes (Variant ID, Chromosome name, Ensembl ID, location, etc.) that will appear in the final table file can be selected by the user.”</p>
</blockquote>
<p>The text above mentiones <em>species</em>, <em>attributes</em> and <em>filters</em>, and we need to combine these elements to query the biomart databases for our annotation. The following code ‘chunks’ show possible values for these elements and how to gather and store the relevant data.</p>
<p>The <code>biomaRt</code> library interfaces with the <a href="http://www.biomart.org">biomart.org</a> online database. Sometimes the biomart website (which offers a browsable database) is down due to maintenance, but its many mirrors can still be used, for instance at <a href="http://www.ensembl.org/biomart/martview/fc683a66d09fd1f42be754bcd90ba7da">Ensembl</a>.</p>
<p>You are required to explore a number of objects and the given example code is most likely not suitable for your data/ organism. The project is well documented on the <a href="https://bioconductor.org/packages/release/bioc/html/biomaRt.html">Bioconductor biomaRt</a> website that links to the <a href="https://bioconductor.org/packages/release/bioc/vignettes/biomaRt/inst/doc/biomaRt.html">biomaRt users guide</a>.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">biomaRt</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use an alternative database server as the regular one sometimes has issues..</span></span>
<span><span class="va">ensembl</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/useMart.html">useMart</a></span><span class="op">(</span><span class="st">"ENSEMBL_MART_ENSEMBL"</span>, host<span class="op">=</span><span class="st">"https://www.ensembl.org"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select the 'ensembl' database</span></span>
<span><span class="va">ensembl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/useMart.html">useMart</a></span><span class="op">(</span><span class="st">"ensembl"</span><span class="op">)</span></span></code></pre></div>
<p>Using the <code>listDatasets</code> function you can get a full list of available datasets. Store this list in an R object and ‘browse’ this object in RStudio to see if your organism is included. Copy the name of the dataset, this is the <em>species</em> element we will use.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mart.datasets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/listDatasets.html">listDatasets</a></span><span class="op">(</span><span class="va">ensembl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select the correct dataset, for the example data we select the 'hsapiens_gene_ensembl' </span></span>
<span><span class="va">ensembl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/useDataset.html">useDataset</a></span><span class="op">(</span><span class="st">'hsapiens_gene_ensembl'</span>, mart <span class="op">=</span> <span class="va">ensembl</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="39%">
<col width="42%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th align="center">dataset</th>
<th align="center">description</th>
<th align="center">version</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">abrachyrhynchus_gene_ensembl</td>
<td align="center">Pink-footed goose genes
(ASM259213v1)</td>
<td align="center">ASM259213v1</td>
</tr>
<tr class="even">
<td align="center">acalliptera_gene_ensembl</td>
<td align="center">Eastern happy genes
(fAstCal1.2)</td>
<td align="center">fAstCal1.2</td>
</tr>
<tr class="odd">
<td align="center">acarolinensis_gene_ensembl</td>
<td align="center">Green anole genes
(AnoCar2.0v2)</td>
<td align="center">AnoCar2.0v2</td>
</tr>
<tr class="even">
<td align="center">acchrysaetos_gene_ensembl</td>
<td align="center">Golden eagle genes
(bAquChr1.2)</td>
<td align="center">bAquChr1.2</td>
</tr>
<tr class="odd">
<td align="center">acitrinellus_gene_ensembl</td>
<td align="center">Midas cichlid genes (Midas_v5)</td>
<td align="center">Midas_v5</td>
</tr>
<tr class="even">
<td align="center">amelanoleuca_gene_ensembl</td>
<td align="center">Giant panda genes
(ASM200744v2)</td>
<td align="center">ASM200744v2</td>
</tr>
</tbody>
</table></div>
<p>Subset of the 214 datasets available</p>
<p>Next is deciding on a filter. For this we can use the <code>listFilters</code> function on the <code>ensembl</code> object, storing the full list of filters. Here too it is wise to view this in RStudio to find the filter to use.</p>
<p>The filter specifies <em>what</em> you will use to search on. For instance, the <code>AnnotationDbi</code> queries above gave us <code>Ensembl</code> gene ID’s and we could use those with the <code>ensembl_gene_id</code> filter. When viewing the list of filters in RStudio you can use the search text-box in the top-right of the view, for example with <code>ensembl</code> to look for filters to use with this type of identifier.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/listFilters.html">listFilters</a></span><span class="op">(</span><span class="va">ensembl</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table style="width:86%;" class="table table-sm">
<colgroup>
<col width="40%">
<col width="45%">
</colgroup>
<thead><tr class="header">
<th align="center">name</th>
<th align="center">description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">chromosome_name</td>
<td align="center">Chromosome/scaffold name</td>
</tr>
<tr class="even">
<td align="center">start</td>
<td align="center">Start</td>
</tr>
<tr class="odd">
<td align="center">end</td>
<td align="center">End</td>
</tr>
<tr class="even">
<td align="center">band_start</td>
<td align="center">Band Start</td>
</tr>
<tr class="odd">
<td align="center">band_end</td>
<td align="center">Band End</td>
</tr>
<tr class="even">
<td align="center">marker_start</td>
<td align="center">Marker Start</td>
</tr>
<tr class="odd">
<td align="center">marker_end</td>
<td align="center">Marker End</td>
</tr>
<tr class="even">
<td align="center">strand</td>
<td align="center">Strand</td>
</tr>
<tr class="odd">
<td align="center">chromosomal_region</td>
<td align="center">e.g. 1:100:10000:-1,
1:100000:200000:1</td>
</tr>
<tr class="even">
<td align="center">with_biogrid</td>
<td align="center">With BioGRID Interaction data,
The General Repository for
Interaction Datasets ID(s)</td>
</tr>
<tr class="odd">
<td align="center">with_ccds</td>
<td align="center">With CCDS ID(s)</td>
</tr>
<tr class="even">
<td align="center">with_chembl</td>
<td align="center">With ChEMBL ID(s)</td>
</tr>
<tr class="odd">
<td align="center">with_dbass3</td>
<td align="center">With DataBase of Aberrant 3’
Splice Sites ID(s)</td>
</tr>
<tr class="even">
<td align="center">with_dbass5</td>
<td align="center">With DataBase of Aberrant 5’
Splice Sites ID(s)</td>
</tr>
<tr class="odd">
<td align="center">with_entrezgene_trans_name</td>
<td align="center">With EntrezGene transcript
name ID(s)</td>
</tr>
</tbody>
</table></div>
<p>Subset of the 437 available filters</p>
<p>Finally we get to the point to determine what data we would like to get from the database. These are the <code>attributes</code> which we can get with the <code>listAttributes</code> function on the <code>ensembl</code> object. Again - and especially with the attributes since there are often &gt;1000 of selectable options - we store the attributes and view them in RStudio to look for data that we want.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">attributes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/listAttributes.html">listAttributes</a></span><span class="op">(</span><span class="va">ensembl</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="40%">
<col width="41%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="center">name</th>
<th align="center">description</th>
<th align="center">page</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">ensembl_gene_id</td>
<td align="center">Gene stable ID</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">ensembl_gene_id_version</td>
<td align="center">Gene stable ID version</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">ensembl_transcript_id</td>
<td align="center">Transcript stable ID</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">ensembl_transcript_id_version</td>
<td align="center">Transcript stable ID version</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">ensembl_peptide_id</td>
<td align="center">Protein stable ID</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">ensembl_peptide_id_version</td>
<td align="center">Protein stable ID version</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">ensembl_exon_id</td>
<td align="center">Exon stable ID</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">description</td>
<td align="center">Gene description</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">chromosome_name</td>
<td align="center">Chromosome/scaffold name</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">start_position</td>
<td align="center">Gene start (bp)</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">end_position</td>
<td align="center">Gene end (bp)</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">strand</td>
<td align="center">Strand</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">band</td>
<td align="center">Karyotype band</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">transcript_start</td>
<td align="center">Transcript start (bp)</td>
<td align="center">feature_page</td>
</tr>
<tr class="odd">
<td align="center">transcript_end</td>
<td align="center">Transcript end (bp)</td>
<td align="center">feature_page</td>
</tr>
<tr class="even">
<td align="center">transcription_start_site</td>
<td align="center">Transcription start site (TSS)</td>
<td align="center">feature_page</td>
</tr>
</tbody>
</table></div>
<p>Subset of the 3172 available attributes</p>
<p>If we want to have the gene chromosome, start- and end-position as well as its description (note, just as an example, there is other, more interesting information available too!) we combine this in a character vector (<code>attrs.get</code>, see below). There is one <em>caveat</em> though, the <em>order</em> in which you get back the results are <strong>not</strong> the same as the input order! This means that we cannot simple combine the data with our original data set but we need to <strong>merge</strong> it together. However, to be able to merge the data we need to know which record belongs to which gene and therefore we add our selected <code>filter</code> (in our case the <code>ensembl_gene_id</code>) to the list of attributes to get. Then, when we get the <code>results dataframe</code> we can use the <code>merge</code> function in R to combine the gene information with the actual data:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-merge.html">merge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ipsc.tri.vs.di</span>, y <span class="op">=</span> <span class="va">results</span>, by.x <span class="op">=</span> <span class="st">'Ensembl'</span>, by.y <span class="op">=</span> <span class="st">'ensembl_gene_id'</span><span class="op">)</span></span></code></pre></div>
<p>We now have all three needed elements (species, filter and attributes) so we are ready to query the database with the <code>getBM</code> function (read the help using <code><a href="https://rdrr.io/pkg/biomaRt/man/getBM.html">?getBM</a></code>).</p>
<p>The example below retrieves data using a set of five Ensembl gene IDs since not all genes have an Ensembl ID as we’ve seen above, so we filter those out first and use this as the <code>values</code> parameter below.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set the 'attributes' values</span></span>
<span><span class="va">attrs.get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ensembl_gene_id"</span>, <span class="st">"chromosome_name"</span>, </span>
<span>               <span class="st">"start_position"</span>,<span class="st">"end_position"</span>, <span class="st">"description"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform a biomaRt query using 'getBM'</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/getBM.html">getBM</a></span><span class="op">(</span>attributes <span class="op">=</span> <span class="va">attrs.get</span>,</span>
<span>                 filters <span class="op">=</span> <span class="st">"ensembl_gene_id"</span>,</span>
<span>                 values <span class="op">=</span> <span class="va">ipsc.tri.vs.di</span><span class="op">$</span><span class="va">Ensembl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, </span>
<span>                 mart <span class="op">=</span> <span class="va">ensembl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span><span class="op">$</span><span class="va">gene_length</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">end_position</span> <span class="op">-</span> <span class="va">results</span><span class="op">$</span><span class="va">start_position</span><span class="op">)</span></span></code></pre></div>
<p>The <code>results</code> object is a <code>data.frame</code> with 5 columns that we can merge with our data set giving us the following annotation columns (combined from the <code>AnnotationDBI</code> and <code>biomaRt</code> libraries).</p>
<p>This was just an example on how to use the <code>biomaRt</code> library and it comes down to selecting the correct filter and looking for interesting attributes to retrieve. Further information can be found in the documentation avaialble with `vignette(‘biomaRt’)</p>
</div>
</div>
<div id="references" class="section level2" number="7.3">
<h2>
<span class="header-section-number">B.3</span> References<a class="anchor" aria-label="anchor" href="#references"><i class="fas fa-link"></i></a>
</h2>

<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-deelen15" class="csl-entry">
al., Patrick Deelen et. 2015. <span>“Calling Genotypes from Public RNA-Sequencing Data Enables Identification of Genetic Variants That Affect Gene-Expression Levels.”</span> <em>Genome Medicine</em> 7 (30).
</div>
<div id="ref-R-edgeR" class="csl-entry">
Chen, Yunshun, Aaron Lun, Davis McCarthy, Xiaobei Zhou, Mark Robinson, and Gordon Smyth. 2018. <em>edgeR: Empirical Analysis of Digital Gene Expression Data in r</em>. <a href="http://bioinf.wehi.edu.au/edgeR">http://bioinf.wehi.edu.au/edgeR</a>.
</div>
<div id="ref-R-pander" class="csl-entry">
Daróczi, Gergely, and Roman Tsegelskyi. 2017. <em>Pander: An r ’Pandoc’ Writer</em>. <a href="https://CRAN.R-project.org/package=pander">https://CRAN.R-project.org/package=pander</a>.
</div>
<div id="ref-R-DESeq2" class="csl-entry">
Love, Michael, Simon Anders, and Wolfgang Huber. 2017. <em>DESeq2: Differential Gene Expression Analysis Based on the Negative Binomial Distribution</em>. <a href="https://github.com/mikelove/DESeq2">https://github.com/mikelove/DESeq2</a>.
</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="a1-data_loading.html"><span class="header-section-number">A</span> Loading Expression Data in R</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#a2-annotation"><span class="header-section-number">B</span> Annotating an RNA-Seq Experiment</a></li>
<li><a class="nav-link" href="#download-geo"><span class="header-section-number">B.1</span> Downloading annotation data from GEO</a></li>
<li>
<a class="nav-link" href="#manually-annotate"><span class="header-section-number">B.2</span> Manual Data Annotation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#annotationDBI"><span class="header-section-number">B.2.1</span> Using AnnotationDBI</a></li>
<li><a class="nav-link" href="#using-biomart"><span class="header-section-number">B.2.2</span> Using biomaRt</a></li>
</ul>
</li>
<li><a class="nav-link" href="#references"><span class="header-section-number">B.3</span> References</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/chapters/a2-annotation.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/chapters/a2-annotation.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Capstone Project - Gene Expression Analysis</strong>" was written by Marcel Kempenaar. It was last built on 2024-04-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
